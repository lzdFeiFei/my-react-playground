# OpenSpec å®æˆ˜æŒ‡å—:è®©AIæˆä¸ºä½ çš„æœ€ä½³ç¼–ç¨‹ä¼™ä¼´

## ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ OpenSpec?

### ä¼ ç»Ÿå¼€å‘çš„ä¸‰å¤§ç—›ç‚¹

ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯:

**åœºæ™¯ä¸€:éœ€æ±‚è¿·å¤±**
> å›¢é˜ŸèŠ±äº†ä¸¤å‘¨æ—¶é—´å¼€å‘æ–°åŠŸèƒ½,ä¸Šçº¿åå‘ç°å’Œäº§å“ç»ç†çš„é¢„æœŸå®Œå…¨ä¸åŒã€‚åŸå› ?æœ€åˆçš„éœ€æ±‚æ–‡æ¡£æ—©å·²è¢«é—å¿˜åœ¨æŸä¸ªè§’è½,å¼€å‘è¿‡ç¨‹ä¸­éœ€æ±‚å˜æ›´äº†3æ¬¡,ä½†æ²¡äººè®°å¾—æ›´æ–°æ–‡æ¡£ã€‚

**åœºæ™¯äºŒ:AIç”Ÿæˆçš„ä»£ç ä¸€å›¢ç³Ÿ**
> ä½ æ»¡æ€€æœŸå¾…åœ°è®© AI åŠ©æ‰‹å¸®ä½ å†™ä»£ç ,ç»“æœç”Ÿæˆçš„ä»£ç è™½ç„¶èƒ½è·‘,ä½†æ¶æ„æ··ä¹±ã€é£æ ¼ä¸ä¸€è‡´ã€ç¼ºå°‘é”™è¯¯å¤„ç†ã€‚ä½ èŠ±äº†æ›´å¤šæ—¶é—´ä¿®æ”¹ AI ç”Ÿæˆçš„ä»£ç ,è¿˜ä¸å¦‚è‡ªå·±ä»å¤´å†™ã€‚

**åœºæ™¯ä¸‰:æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯**
> é¡¹ç›®è¿›è¡Œåˆ°ç¬¬6ä¸ªæœˆ,ä»£ç åº“å·²ç»æœ‰15000è¡Œä»£ç ,ä½†æ²¡äººè¯´å¾—æ¸…æ¥šæ¯ä¸ªæ¨¡å—çš„ç¡®åˆ‡èŒè´£ã€‚æ–°äººå…¥èŒéœ€è¦2å‘¨æ‰èƒ½ç†è§£ä»£ç ç»“æ„,æ·»åŠ æ–°åŠŸèƒ½æ€»æ˜¯æ‹…å¿ƒç ´åç°æœ‰é€»è¾‘ã€‚

è¿™äº›é—®é¢˜çš„æ ¹æºæ˜¯ä»€ä¹ˆ?**ç¼ºä¹ä¸€ä¸ªæƒå¨çš„ã€å¯ç»´æŠ¤çš„ã€å®æ—¶åŒæ­¥çš„è§„æ ¼è¯´æ˜(Specification)**ã€‚

### è§„æ ¼é©±åŠ¨å¼€å‘(Spec-Driven Development)çš„å´›èµ·

2025å¹´,è½¯ä»¶å·¥ç¨‹é¢†åŸŸæ­£åœ¨å‘ç”Ÿä¸€åœºé™æ‚„æ‚„çš„é©å‘½ã€‚OpenAI çš„å·¥ç¨‹å¸ˆ Sean Grove åœ¨ AI Engineer å¤§ä¼šä¸Šè¯´:"è§„æ ¼è¯´æ˜,è€Œä¸æ˜¯æç¤ºè¯æˆ–ä»£ç ,æ­£åœ¨æˆä¸ºç¼–ç¨‹çš„åŸºæœ¬å•ä½ã€‚ç¼–å†™è§„æ ¼è¯´æ˜æ˜¯æ–°æ—¶ä»£çš„è¶…èƒ½åŠ›ã€‚"

**æ•°æ®è¯´è¯:**
- GitHub åœ¨2025å¹´9æœˆå‘å¸ƒçš„ Spec Kit å·¥å…·,ä¸¤ä¸ªæœˆå†…è·å¾—è¶…è¿‡8000+ stars
- Microsoftã€Anthropicã€AWS ç­‰ç§‘æŠ€å·¨å¤´çº·çº·æ¨å‡ºæ”¯æŒè§„æ ¼é©±åŠ¨å¼€å‘çš„å·¥å…·
- é‡‡ç”¨è§„æ ¼é©±åŠ¨å¼€å‘çš„å›¢é˜Ÿ,AI ä»£ç ç”Ÿæˆè´¨é‡æå‡ 60%,bug ç‡é™ä½ 45%

ä½†å¸‚é¢ä¸Šçš„å·¥å…·è¦ä¹ˆè¿‡äºå¤æ‚(å­¦ä¹ æˆæœ¬é«˜),è¦ä¹ˆè¿‡äºç®€é™‹(ç¼ºä¹å®Œæ•´å·¥ä½œæµæ”¯æŒ)ã€‚

**è¿™å°±æ˜¯ OpenSpec è¯ç”Ÿçš„ç†ç”±ã€‚**

### OpenSpec çš„è®¾è®¡å“²å­¦

OpenSpec æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è§„æ ¼é©±åŠ¨å¼€å‘å·¥ä½œæµæ¡†æ¶,æ ¸å¿ƒç†å¿µå¯ä»¥ç”¨ä¸‰å¥è¯æ¦‚æ‹¬:

1. **è§„æ ¼æ˜¯å”¯ä¸€çš„çœŸç›¸æº(Single Source of Truth)** - æ‰€æœ‰éœ€æ±‚ã€è®¾è®¡å†³ç­–ã€å®ç°ç»†èŠ‚éƒ½æºäºè§„æ ¼
2. **å˜æ›´æ˜¯ä¸€ç­‰å…¬æ°‘(Changes as First-Class Citizens)** - æ¯æ¬¡åŠŸèƒ½æ·»åŠ ã€ä¿®æ”¹ã€é‡æ„éƒ½é€šè¿‡æ­£å¼çš„å˜æ›´ææ¡ˆæµç¨‹
3. **AI å‹å¥½,äººç±»å¯è¯»(AI-Friendly, Human-Readable)** - ä½¿ç”¨ç»“æ„åŒ–çš„ Markdown æ ¼å¼,æ—¢èƒ½è®© AI ç²¾å‡†ç†è§£,ä¹Ÿèƒ½è®©äººè½»æ¾é˜…è¯»

OpenSpec ä¸æ˜¯ä¸€ä¸ªåºå¤§çš„å·¥å…·,è€Œæ˜¯ä¸€å¥—æœ€ä½³å®è·µ + ä¸€ä¸ªç®€å•çš„ CLIã€‚å®ƒçš„ç›®æ ‡æ˜¯:**è®©ä½ åœ¨ä½¿ç”¨ AI ç¼–ç¨‹æ—¶,è·å¾—ä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹çš„ä¸¥è°¨æ€§,åŒæ—¶ä¿æŒæ•æ·å¼€å‘çš„çµæ´»æ€§**ã€‚

---

## äºŒã€OpenSpec æ ¸å¿ƒæ¦‚å¿µè¯¦è§£

### 2.1 ç›®å½•ç»“æ„:ä¸€åˆ‡äº•ç„¶æœ‰åº

OpenSpec çš„ç›®å½•ç»“æ„æå…¶ç®€æ´,ä½†è•´å«æ·±æ„:

```
openspec/
â”œâ”€â”€ project.md              # é¡¹ç›®å®ªç« :ä¸å¯æ’¼åŠ¨çš„åŸåˆ™
â”œâ”€â”€ specs/                  # å½“å‰çœŸç›¸:å·²éƒ¨ç½²çš„åŠŸèƒ½è§„æ ¼
â”‚   â””â”€â”€ [capability]/       # å•ä¸€èƒ½åŠ›å•å…ƒ
â”‚       â”œâ”€â”€ spec.md         # éœ€æ±‚å’Œåœºæ™¯
â”‚       â””â”€â”€ design.md       # æŠ€æœ¯æ¨¡å¼å’Œæ¶æ„å†³ç­–
â”œâ”€â”€ changes/                # å˜æ›´ææ¡ˆ:å³å°†å‘ç”Ÿçš„æ”¹å˜
â”‚   â”œâ”€â”€ [change-name]/
â”‚   â”‚   â”œâ”€â”€ proposal.md     # ä¸ºä»€ä¹ˆæ”¹?æ”¹ä»€ä¹ˆ?å½±å“èŒƒå›´?
â”‚   â”‚   â”œâ”€â”€ tasks.md        # å®ç°æ¸…å•
â”‚   â”‚   â”œâ”€â”€ design.md       # æŠ€æœ¯å†³ç­–(å¯é€‰)
â”‚   â”‚   â””â”€â”€ specs/          # è§„æ ¼å¢é‡å˜æ›´
â”‚   â”‚       â””â”€â”€ [capability]/
â”‚   â”‚           â””â”€â”€ spec.md # ADDED/MODIFIED/REMOVED
â”‚   â””â”€â”€ archive/            # å·²å®Œæˆçš„å˜æ›´å†å²
```

#### ç†è§£ä¸‰ä¸ªæ ¸å¿ƒç›®å½•

**1. `specs/` - å·²éƒ¨ç½²åŠŸèƒ½çš„è§„æ ¼è¯´æ˜**

è¿™é‡Œå­˜æ”¾çš„æ˜¯**å½“å‰ç”Ÿäº§ç¯å¢ƒ**ä¸­å·²ç»å®ç°çš„åŠŸèƒ½è§„æ ¼ã€‚æ¯ä¸ªå­ç›®å½•ä»£è¡¨ä¸€ä¸ª"èƒ½åŠ›å•å…ƒ(capability)",ä¾‹å¦‚:
- `specs/user-auth/` - ç”¨æˆ·è®¤è¯èƒ½åŠ›
- `specs/payment-processing/` - æ”¯ä»˜å¤„ç†èƒ½åŠ›
- `specs/data-export/` - æ•°æ®å¯¼å‡ºèƒ½åŠ›

> **é‡‘ç§‘ç‰å¾‹:** specs/ ç›®å½•å¿…é¡»å§‹ç»ˆåæ˜ ç”Ÿäº§ç¯å¢ƒçš„çœŸå®çŠ¶æ€ã€‚å¦‚æœä»£ç å·²ç»éƒ¨ç½²,è§„æ ¼å¿…é¡»åŒæ­¥æ›´æ–°ã€‚

**2. `changes/` - å˜æ›´ææ¡ˆç›®å½•**

è¿™é‡Œå­˜æ”¾çš„æ˜¯**æ­£åœ¨è§„åˆ’æˆ–å®ç°ä¸­**çš„åŠŸèƒ½å˜æ›´ã€‚æ¯ä¸ªå˜æ›´éƒ½æœ‰å”¯ä¸€çš„ ID(å¦‚ `add-two-factor-auth`),åŒ…å«å®Œæ•´çš„ææ¡ˆæ–‡æ¡£å’Œè§„æ ¼å¢é‡ã€‚

> **å…³é”®åŒºåˆ«:** changes/ æ˜¯"å°†è¦æˆä¸ºä»€ä¹ˆ",specs/ æ˜¯"ç°åœ¨æ˜¯ä»€ä¹ˆ"ã€‚

**3. `changes/archive/` - å˜æ›´å†å²æ¡£æ¡ˆ**

å·²å®Œæˆçš„å˜æ›´ä¼šè¢«ç§»åŠ¨åˆ°è¿™é‡Œ,ä¿ç•™å†å²è®°å½•ã€‚æ¡£æ¡ˆç›®å½•æŒ‰æ—¥æœŸå‘½å,å¦‚ `2025-10-31-add-two-factor-auth/`ã€‚

> **æœ€ä½³å®è·µ:** æ°¸è¿œä¸è¦åˆ é™¤ archive/,å®ƒæ˜¯é¡¹ç›®æ¼”è¿›çš„å®è´µå†å²è®°å½•ã€‚

### 2.2 Capability(èƒ½åŠ›å•å…ƒ):å¦‚ä½•åˆ’åˆ†åŠŸèƒ½

OpenSpec ä½¿ç”¨"èƒ½åŠ›å•å…ƒ"ä½œä¸ºç»„ç»‡è§„æ ¼çš„åŸºæœ¬å•ä½ã€‚ä½†å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆç†çš„ capability?

#### åˆ’åˆ†åŸåˆ™

**âœ… å¥½çš„ capability è®¾è®¡:**

```
user-auth/           # ç”¨æˆ·è®¤è¯(å•ä¸€èŒè´£)
â”œâ”€â”€ spec.md
â””â”€â”€ design.md

payment-capture/     # æ”¯ä»˜æ•è·(åŠ¨è¯-åè¯ç»“æ„)
â”œâ”€â”€ spec.md
â””â”€â”€ design.md

notification-email/  # é‚®ä»¶é€šçŸ¥(æ˜ç¡®è¾¹ç•Œ)
â”œâ”€â”€ spec.md
â””â”€â”€ design.md
```

**âŒ ç³Ÿç³•çš„ capability è®¾è®¡:**

```
backend/             # å¤ªå®½æ³›,æ²¡æœ‰æ˜ç¡®è¾¹ç•Œ
â”œâ”€â”€ spec.md

user-and-admin/      # åŒ…å«"AND",è¯´æ˜èŒè´£ä¸å•ä¸€
â”œâ”€â”€ spec.md

utils/               # å·¥å…·ç±»,ä¸æ˜¯ä¸šåŠ¡èƒ½åŠ›
â”œâ”€â”€ spec.md
```

#### é»„é‡‘æ³•åˆ™:"10åˆ†é’Ÿå¯ç†è§£æ€§"

ä¸€ä¸ªå¥½çš„ capability åº”è¯¥æ»¡è¶³:
1. æ–°æˆå‘˜é˜…è¯» `spec.md` 10åˆ†é’Ÿå†…èƒ½ç†è§£å…¶èŒè´£
2. æè¿°æ—¶ä¸éœ€è¦ä½¿ç”¨"AND"è¿æ¥å¤šä¸ªèŒè´£
3. ä¿®æ”¹è¿™ä¸ª capability ä¸ä¼šå½±å“å…¶ä»– capability çš„æ ¸å¿ƒé€»è¾‘

**å®æˆ˜æ¡ˆä¾‹:**

å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªç”µå•†ç³»ç»Ÿ,éœ€è¦å®ç°"è®¢å•ç®¡ç†"åŠŸèƒ½ã€‚ä¸è¦åˆ›å»ºä¸€ä¸ªå·¨å¤§çš„ `order-management/` capability,è€Œåº”è¯¥æ‹†åˆ†ä¸º:

- `order-creation/` - è®¢å•åˆ›å»º
- `order-payment/` - è®¢å•æ”¯ä»˜
- `order-fulfillment/` - è®¢å•å±¥çº¦
- `order-cancellation/` - è®¢å•å–æ¶ˆ

æ¯ä¸ª capability éƒ½æœ‰æ¸…æ™°çš„è¾¹ç•Œ,å¯ä»¥ç‹¬ç«‹æ¼”è¿›ã€‚

### 2.3 Spec.md æ ¼å¼:éœ€æ±‚çš„æ ‡å‡†è¡¨è¾¾

OpenSpec çš„ `spec.md` æ–‡ä»¶ä½¿ç”¨ä¸€ç§ç»“æ„åŒ–çš„ Markdown æ ¼å¼,æ ¸å¿ƒæ˜¯**éœ€æ±‚(Requirement) + åœºæ™¯(Scenario)**ã€‚

#### åŸºæœ¬ç»“æ„

```markdown
## Requirements

### Requirement: ç”¨æˆ·ç™»å½•
ç³»ç»Ÿå¿…é¡»(SHALL)æä¾›ç”¨æˆ·åå’Œå¯†ç ç™»å½•åŠŸèƒ½ã€‚

#### Scenario: ç™»å½•æˆåŠŸ
- **WHEN** ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç 
- **THEN** ç³»ç»Ÿè¿”å› JWT token
- **AND** é‡å®šå‘åˆ°ç”¨æˆ·ä¸»é¡µ

#### Scenario: ç™»å½•å¤±è´¥
- **WHEN** ç”¨æˆ·è¾“å…¥é”™è¯¯çš„å¯†ç 
- **THEN** ç³»ç»Ÿè¿”å› 401 é”™è¯¯
- **AND** æç¤º"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
```

#### å…³é”®è¦ç‚¹

**1. Requirement ä½¿ç”¨ SHALL/MUST å…³é”®è¯**

- SHALL/MUST - å¼ºåˆ¶æ€§éœ€æ±‚(normative)
- SHOULD - æ¨èæ€§éœ€æ±‚(å¯é€‰ä½†å¼ºçƒˆå»ºè®®)
- MAY - å®Œå…¨å¯é€‰çš„éœ€æ±‚

**2. æ¯ä¸ª Requirement å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ª Scenario**

Scenario æ˜¯éœ€æ±‚çš„å¯éªŒè¯è¡¨è¾¾ã€‚æ²¡æœ‰ Scenario çš„ Requirement æ˜¯ä¸å®Œæ•´çš„,å› ä¸ºæ— æ³•éªŒè¯æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚

**3. Scenario æ ¼å¼å¿…é¡»ä¸¥æ ¼éµå®ˆ**

âœ… **æ­£ç¡®æ ¼å¼:**
```markdown
#### Scenario: æè¿°æ€§åç§°
- **WHEN** å‰ç½®æ¡ä»¶
- **THEN** é¢„æœŸç»“æœ
- **AND** é¢å¤–çš„ç»“æœ
```

âŒ **é”™è¯¯æ ¼å¼:**
```markdown
- **Scenario: åç§°**        # ä¸è¦ç”¨åˆ—è¡¨é¡¹
**Scenario**: åç§°          # ä¸è¦ç”¨ç²—ä½“å†’å·
### Scenario: åç§°          # ä¸è¦ç”¨ä¸‰çº§æ ‡é¢˜
```

> **è¡€æ³ªæ•™è®­:** OpenSpec CLI çš„ Scenario è§£æå™¨å¯¹æ ¼å¼éå¸¸ä¸¥æ ¼ã€‚ä½¿ç”¨é”™è¯¯æ ¼å¼ä¼šå¯¼è‡´éªŒè¯å¤±è´¥,ä¸”é”™è¯¯æç¤ºä¸æ˜æ˜¾ã€‚åŠ¡å¿…ä½¿ç”¨ `####` å››çº§æ ‡é¢˜ã€‚

### 2.4 Delta æœºåˆ¶:å¢é‡å¼çš„å˜æ›´ç®¡ç†

OpenSpec çš„ç²¾é«“åœ¨äº**å¢é‡å˜æ›´(Delta)**æœºåˆ¶ã€‚å½“ä½ è¦ä¿®æ”¹ä¸€ä¸ªç°æœ‰çš„ capability æ—¶,ä¸æ˜¯ç›´æ¥ä¿®æ”¹ `specs/[capability]/spec.md`,è€Œæ˜¯åœ¨ `changes/[change-id]/specs/[capability]/spec.md` ä¸­å†™å…¥å¢é‡å˜æ›´ã€‚

#### å››ç§ Delta æ“ä½œ

**1. ADDED - æ–°å¢éœ€æ±‚**

ç”¨äºæ·»åŠ å…¨æ–°çš„åŠŸèƒ½éœ€æ±‚:

```markdown
## ADDED Requirements

### Requirement: åŒå› ç´ è®¤è¯
ç”¨æˆ·å¿…é¡»åœ¨ç™»å½•åæä¾›ç¬¬äºŒå› ç´ éªŒè¯ã€‚

#### Scenario: OTP éªŒè¯æˆåŠŸ
- **WHEN** ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„ OTP ç 
- **THEN** ç³»ç»Ÿå®Œæˆç™»å½•æµç¨‹
```

**2. MODIFIED - ä¿®æ”¹éœ€æ±‚**

ç”¨äºä¿®æ”¹ç°æœ‰éœ€æ±‚çš„è¡Œä¸º:

```markdown
## MODIFIED Requirements

### Requirement: ç”¨æˆ·ç™»å½•
ç³»ç»Ÿå¿…é¡»æä¾›ç”¨æˆ·åå’Œå¯†ç ç™»å½•åŠŸèƒ½,å¹¶æ”¯æŒ OAuth2 ç¬¬ä¸‰æ–¹ç™»å½•ã€‚

#### Scenario: ç™»å½•æˆåŠŸ
- **WHEN** ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç 
- **THEN** ç³»ç»Ÿè¿”å› JWT token
- **AND** é‡å®šå‘åˆ°ç”¨æˆ·ä¸»é¡µ

#### Scenario: OAuth2 ç™»å½•æˆåŠŸ
- **WHEN** ç”¨æˆ·é€šè¿‡ Google OAuth2 æˆæƒ
- **THEN** ç³»ç»Ÿåˆ›å»ºæˆ–å…³è”è´¦æˆ·
- **AND** è¿”å› JWT token
```

> **å…³é”®æ³¨æ„:** MODIFIED å¿…é¡»åŒ…å«å®Œæ•´çš„éœ€æ±‚å†…å®¹(åŸæœ‰çš„ + æ–°å¢çš„)ã€‚å½’æ¡£æ—¶,OpenSpec ä¼šç”¨è¿™ä¸ªå®Œæ•´å†…å®¹æ›¿æ¢åŸéœ€æ±‚ã€‚

**3. REMOVED - åˆ é™¤éœ€æ±‚**

ç”¨äºåºŸå¼ƒä¸å†éœ€è¦çš„åŠŸèƒ½:

```markdown
## REMOVED Requirements

### Requirement: ç”¨æˆ·åç™»å½•
**Reason**: ä¸ºäº†æé«˜å®‰å…¨æ€§,å¼ºåˆ¶ä½¿ç”¨é‚®ç®±ç™»å½•
**Migration**: ç”¨æˆ·éœ€è¦åœ¨ä¸‹æ¬¡ç™»å½•æ—¶ç»‘å®šé‚®ç®±,æ—§çš„ç”¨æˆ·åå°†ä¸å†æœ‰æ•ˆ
```

**4. RENAMED - é‡å‘½åéœ€æ±‚**

ä»…ç”¨äºéœ€æ±‚åç§°å˜æ›´,ä¸æ”¹å˜è¡Œä¸º:

```markdown
## RENAMED Requirements
- FROM: `### Requirement: ç”¨æˆ·ç™»å½•`
- TO: `### Requirement: ç”¨æˆ·èº«ä»½è®¤è¯`
```

#### Delta æœ€ä½³å®è·µ

**ä½•æ—¶ä½¿ç”¨ ADDED vs MODIFIED?**

è¿™æ˜¯åˆå­¦è€…æœ€å¸¸çŠ¯çš„é”™è¯¯ã€‚åˆ¤æ–­æ ‡å‡†:

- **ADDED:** æ–°åŠŸèƒ½æ˜¯æ­£äº¤çš„(orthogonal),å¯ä»¥ç‹¬ç«‹å­˜åœ¨
- **MODIFIED:** ä¿®æ”¹äº†ç°æœ‰éœ€æ±‚çš„è¡Œä¸ºã€èŒƒå›´æˆ–éªŒæ”¶æ ‡å‡†

**æ¡ˆä¾‹åˆ†æ:**

å‡è®¾ç°æœ‰éœ€æ±‚:
```markdown
### Requirement: ç”¨æˆ·ç™»å½•
ç³»ç»Ÿå¿…é¡»æä¾›ç”¨æˆ·åå’Œå¯†ç ç™»å½•åŠŸèƒ½ã€‚
```

**æƒ…å†µ1: æ·»åŠ  OAuth2 ç™»å½•**
- å¦‚æœ OAuth2 æ˜¯æ›¿ä»£æ–¹æ¡ˆ,ä¿®æ”¹äº†ç™»å½•è¡Œä¸º â†’ ä½¿ç”¨ **MODIFIED**
- å¦‚æœ OAuth2 æ˜¯é¢å¤–é€‰é¡¹,åŸæœ‰ç™»å½•ä¸å˜ â†’ å¯ä»¥ä½¿ç”¨ **ADDED**(æ–°å¢"OAuth2 ç™»å½•"éœ€æ±‚)

**æƒ…å†µ2: æ·»åŠ è®°ä½æˆ‘åŠŸèƒ½**
- "è®°ä½æˆ‘"æ˜¯ç™»å½•æµç¨‹çš„æ‰©å±•,ä¿®æ”¹äº†ç™»å½•è¡Œä¸º â†’ ä½¿ç”¨ **MODIFIED**

**æƒ…å†µ3: æ·»åŠ ç™»å½•æ—¥å¿—**
- æ—¥å¿—æ˜¯æ­£äº¤åŠŸèƒ½,ä¸æ”¹å˜ç™»å½•æœ¬èº« â†’ ä½¿ç”¨ **ADDED**(æ–°å¢"ç™»å½•å®¡è®¡æ—¥å¿—"éœ€æ±‚)

---

## ä¸‰ã€OpenSpec å®Œæ•´å·¥ä½œæµå®æˆ˜

### 3.1 ä¸‰é˜¶æ®µå·¥ä½œæµæ¦‚è§ˆ

```mermaid
graph LR
    A[é˜¶æ®µ1: åˆ›å»ºå˜æ›´ææ¡ˆ] --> B[é˜¶æ®µ2: å®ç°å˜æ›´]
    B --> C[é˜¶æ®µ3: å½’æ¡£å˜æ›´]
    C --> D[è§„æ ¼åŒæ­¥åˆ° specs/]

    A1[1. æ¢ç´¢ç°çŠ¶] --> A2[2. é€‰æ‹©å˜æ›´ID]
    A2 --> A3[3. ç¼–å†™ææ¡ˆ]
    A3 --> A4[4. åˆ›å»ºDelta]
    A4 --> A5[5. éªŒè¯æ ¼å¼]

    B1[1. é˜…è¯»ææ¡ˆ] --> B2[2. é˜…è¯»è®¾è®¡]
    B2 --> B3[3. æŒ‰ tasks.md å®ç°]
    B3 --> B4[4. æ›´æ–°æ¸…å•]

    C1[1. å½’æ¡£å˜æ›´ç›®å½•] --> C2[2. åˆå¹¶ Delta åˆ° specs/]
    C2 --> C3[3. æœ€ç»ˆéªŒè¯]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#e8f5e9
```

### 3.2 é˜¶æ®µ1: åˆ›å»ºå˜æ›´ææ¡ˆ

#### æ­¥éª¤0: åˆ¤æ–­æ˜¯å¦éœ€è¦ææ¡ˆ

**æ— éœ€ææ¡ˆçš„æƒ…å†µ(ç›´æ¥ä¿®æ”¹ä»£ç ):**
- âœ… Bug ä¿®å¤(æ¢å¤åŸæœ‰è§„æ ¼çš„è¡Œä¸º)
- âœ… æ‹¼å†™é”™è¯¯ã€æ ¼å¼è°ƒæ•´ã€æ³¨é‡Šä¿®æ”¹
- âœ… éç ´åæ€§ä¾èµ–æ›´æ–°
- âœ… é…ç½®æ–‡ä»¶è°ƒæ•´
- âœ… ä¸ºç°æœ‰è¡Œä¸ºè¡¥å……æµ‹è¯•

**å¿…é¡»åˆ›å»ºææ¡ˆçš„æƒ…å†µ:**
- âš ï¸ æ–°å¢åŠŸèƒ½æˆ–èƒ½åŠ›
- âš ï¸ ç ´åæ€§å˜æ›´(APIã€æ•°æ®åº“æ¨¡å¼ç­‰)
- âš ï¸ æ¶æ„è°ƒæ•´æˆ–è®¾è®¡æ¨¡å¼å˜æ›´
- âš ï¸ æ€§èƒ½ä¼˜åŒ–(æ”¹å˜è¡Œä¸º)
- âš ï¸ å®‰å…¨ç­–ç•¥æ›´æ–°

**å†³ç­–æ ‘:**
```
æ˜¯å¦æ”¹å˜ç”¨æˆ·å¯è§‚å¯Ÿçš„è¡Œä¸º?
â”œâ”€ å¦ â†’ æ˜¯å¦æ”¹å˜å¼€å‘è€… API?
â”‚   â”œâ”€ å¦ â†’ æ˜¯å¦æ”¹å˜æ¶æ„æ¨¡å¼?
â”‚   â”‚   â”œâ”€ å¦ â†’ æ— éœ€ææ¡ˆ,ç›´æ¥ä¿®æ”¹
â”‚   â”‚   â””â”€ æ˜¯ â†’ éœ€è¦ææ¡ˆ
â”‚   â””â”€ æ˜¯ â†’ éœ€è¦ææ¡ˆ
â””â”€ æ˜¯ â†’ éœ€è¦ææ¡ˆ
```

#### æ­¥éª¤1: æ¢ç´¢é¡¹ç›®ç°çŠ¶

åœ¨åˆ›å»ºæ–°çš„å˜æ›´ææ¡ˆå‰,**å¿…é¡»**äº†è§£å½“å‰é¡¹ç›®çŠ¶æ€,é¿å…é‡å¤æˆ–å†²çªã€‚

```bash
# 1. æŸ¥çœ‹æ‰€æœ‰ç°æœ‰ capability
openspec list --specs

# ç¤ºä¾‹è¾“å‡º:
# Available Specs:
#   - user-auth
#   - payment-processing
#   - data-export

# 2. æŸ¥çœ‹æ­£åœ¨è¿›è¡Œçš„å˜æ›´
openspec list

# ç¤ºä¾‹è¾“å‡º:
# Active Changes:
#   - add-two-factor-auth (affects: user-auth)
#   - refactor-payment-retry (affects: payment-processing)

# 3. æŸ¥çœ‹ç‰¹å®š capability çš„è¯¦ç»†å†…å®¹
openspec show user-auth --type spec

# 4. å…¨æ–‡æœç´¢(ä½¿ç”¨ ripgrep)
rg -n "Requirement:|Scenario:" openspec/specs
rg -n "^#|Requirement:" openspec/changes
```

**å®æˆ˜æŠ€å·§:**

å‡è®¾ä½ è¦æ·»åŠ "å¯†ç é‡ç½®"åŠŸèƒ½,æœç´¢æ­¥éª¤:

```bash
# 1. æ£€æŸ¥æ˜¯å¦å·²æœ‰ç›¸å…³ capability
openspec list --specs | grep -i password
openspec list --specs | grep -i auth

# 2. æŸ¥çœ‹ user-auth çš„ç°æœ‰éœ€æ±‚
openspec show user-auth --type spec

# 3. æ£€æŸ¥æ˜¯å¦æœ‰äººå·²ç»åœ¨åšç±»ä¼¼çš„å˜æ›´
openspec list | grep -i password
openspec list | grep -i reset

# 4. å…¨æ–‡æœç´¢æ˜¯å¦æåˆ°è¿‡å¯†ç é‡ç½®
rg -i "password reset" openspec/
```

#### æ­¥éª¤2: é€‰æ‹©å˜æ›´ID

å˜æ›´ ID æ˜¯å˜æ›´ææ¡ˆçš„å”¯ä¸€æ ‡è¯†ç¬¦,éµå¾ªå‘½åçº¦å®š:

**æ ¼å¼:** `<verb>-<noun>-<noun>` (kebab-case)

**åŠ¨è¯å‰ç¼€æ¨è:**
- `add-` - æ–°å¢åŠŸèƒ½
- `update-` - æ›´æ–°ç°æœ‰åŠŸèƒ½
- `remove-` - åˆ é™¤åŠŸèƒ½
- `refactor-` - é‡æ„(ä¸æ”¹å˜å¤–éƒ¨è¡Œä¸º)
- `fix-` - ä¿®å¤é—®é¢˜(å¦‚æœéœ€è¦ææ¡ˆçš„è¯)
- `migrate-` - æ•°æ®æˆ–æ¶æ„è¿ç§»

**âœ… å¥½çš„å˜æ›´ ID:**
- `add-two-factor-auth`
- `update-payment-retry-logic`
- `remove-legacy-api-v1`
- `refactor-database-connection`
- `migrate-postgres-to-v15`

**âŒ ç³Ÿç³•çš„å˜æ›´ ID:**
- `feature` (å¤ªå®½æ³›)
- `update_code` (ä½¿ç”¨ä¸‹åˆ’çº¿,ä¸æ˜¯kebab-case)
- `AddTwoFactorAuth` (ä½¿ç”¨å¤§é©¼å³°)
- `add-2fa` (ç¼©å†™ä¸æ¸…æ™°,é™¤éé¡¹ç›®ä¸­é€šç”¨)

**å”¯ä¸€æ€§æ£€æŸ¥:**
```bash
# æ£€æŸ¥ ID æ˜¯å¦å·²è¢«ä½¿ç”¨
ls openspec/changes/ | grep "your-change-id"
ls openspec/changes/archive/ | grep "your-change-id"
```

#### æ­¥éª¤3: æ­å»ºææ¡ˆç›®å½•ç»“æ„

```bash
# è®¾ç½®å˜æ›´ ID
CHANGE=add-password-reset

# åˆ›å»ºç›®å½•ç»“æ„
mkdir -p openspec/changes/$CHANGE/specs/user-auth

# åˆ›å»º proposal.md
cat > openspec/changes/$CHANGE/proposal.md << 'EOF'
## Why
ç”¨æˆ·ç»å¸¸å¿˜è®°å¯†ç ,ç›®å‰åªèƒ½è”ç³»å®¢æœé‡ç½®,æ”¯æŒæˆæœ¬é«˜ã€‚æä¾›è‡ªåŠ©å¯†ç é‡ç½®åŠŸèƒ½å¯ä»¥æ”¹å–„ç”¨æˆ·ä½“éªŒå¹¶é™ä½è¿è¥æˆæœ¬ã€‚

## What Changes
- æ·»åŠ "å¿˜è®°å¯†ç "å…¥å£ç‚¹
- å®ç°é‚®ç®±éªŒè¯ç å‘é€å’ŒéªŒè¯é€»è¾‘
- æä¾›å¯†ç é‡ç½®è¡¨å•å’Œå®‰å…¨æ£€æŸ¥
- è®°å½•å¯†ç é‡ç½®æ“ä½œæ—¥å¿—

## Impact
- Affected specs: user-auth
- Affected code:
  - `src/auth/routes.ts` - æ–°å¢ API ç«¯ç‚¹
  - `src/auth/password-reset.service.ts` - æ–°æœåŠ¡
  - `src/email/templates/` - æ–°å¢é‚®ä»¶æ¨¡æ¿
  - `frontend/pages/reset-password.tsx` - æ–°é¡µé¢
EOF

# åˆ›å»º tasks.md
cat > openspec/changes/$CHANGE/tasks.md << 'EOF'
## 1. åç«¯å®ç°
- [ ] 1.1 åˆ›å»ºå¯†ç é‡ç½®ä»¤ç‰Œè¡¨(tokens è¡¨,åŒ…å« user_id, token, expires_at)
- [ ] 1.2 å®ç° POST /auth/reset-password/request ç«¯ç‚¹(å‘é€éªŒè¯ç )
- [ ] 1.3 å®ç° POST /auth/reset-password/verify ç«¯ç‚¹(éªŒè¯å¹¶é‡ç½®å¯†ç )
- [ ] 1.4 æ·»åŠ ä»¤ç‰Œè¿‡æœŸæ¸…ç†å®šæ—¶ä»»åŠ¡

## 2. é‚®ä»¶æœåŠ¡
- [ ] 2.1 åˆ›å»ºå¯†ç é‡ç½®é‚®ä»¶æ¨¡æ¿
- [ ] 2.2 å®ç°é‚®ä»¶å‘é€é€»è¾‘(é›†æˆç°æœ‰é‚®ä»¶æœåŠ¡)
- [ ] 2.3 æ·»åŠ å‘é€é¢‘ç‡é™åˆ¶(åŒä¸€ç”¨æˆ·10åˆ†é’Ÿå†…åªèƒ½è¯·æ±‚1æ¬¡)

## 3. å‰ç«¯å®ç°
- [ ] 3.1 åˆ›å»º"å¿˜è®°å¯†ç "é¡µé¢
- [ ] 3.2 åˆ›å»ºå¯†ç é‡ç½®è¡¨å•é¡µé¢
- [ ] 3.3 æ·»åŠ å¯†ç å¼ºåº¦éªŒè¯
- [ ] 3.4 å®ç°å‰ç«¯è¡¨å•éªŒè¯å’Œé”™è¯¯å¤„ç†

## 4. å®‰å…¨å’Œæµ‹è¯•
- [ ] 4.1 æ·»åŠ  CSRF ä¿æŠ¤
- [ ] 4.2 å®ç°æš´åŠ›ç ´è§£é˜²æŠ¤(IP çº§åˆ«é™æµ)
- [ ] 4.3 ç¼–å†™å•å…ƒæµ‹è¯•(è¦†ç›–æ ¸å¿ƒé€»è¾‘)
- [ ] 4.4 ç¼–å†™é›†æˆæµ‹è¯•(ç«¯åˆ°ç«¯æµç¨‹)
- [ ] 4.5 å®‰å…¨å®¡è®¡(æ£€æŸ¥å¸¸è§å¯†ç é‡ç½®æ¼æ´)
EOF
```

#### æ­¥éª¤4: ç¼–å†™è§„æ ¼ Delta

è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚åœ¨ `changes/add-password-reset/specs/user-auth/spec.md` ä¸­ç¼–å†™å¢é‡å˜æ›´:

```markdown
## ADDED Requirements

### Requirement: å¯†ç é‡ç½®è¯·æ±‚
ç³»ç»Ÿå¿…é¡»å…è®¸ç”¨æˆ·é€šè¿‡é‚®ç®±è¯·æ±‚å¯†ç é‡ç½®ã€‚

#### Scenario: è¯·æ±‚æˆåŠŸ
- **WHEN** ç”¨æˆ·è¾“å…¥æ³¨å†Œé‚®ç®±å¹¶è¯·æ±‚å¯†ç é‡ç½®
- **THEN** ç³»ç»Ÿç”Ÿæˆå”¯ä¸€çš„é‡ç½®ä»¤ç‰Œ(æœ‰æ•ˆæœŸ15åˆ†é’Ÿ)
- **AND** å‘é€åŒ…å«é‡ç½®é“¾æ¥çš„é‚®ä»¶åˆ°ç”¨æˆ·é‚®ç®±
- **AND** è¿”å› 200 çŠ¶æ€ç å’Œ"é‚®ä»¶å·²å‘é€"æç¤º

#### Scenario: é‚®ç®±ä¸å­˜åœ¨
- **WHEN** ç”¨æˆ·è¾“å…¥çš„é‚®ç®±æœªæ³¨å†Œ
- **THEN** ç³»ç»Ÿä»è¿”å›"é‚®ä»¶å·²å‘é€"æç¤º(é˜²æ­¢é‚®ç®±æšä¸¾æ”»å‡»)
- **AND** ä¸å®é™…å‘é€é‚®ä»¶

#### Scenario: è¯·æ±‚é¢‘ç‡é™åˆ¶
- **WHEN** ç”¨æˆ·åœ¨10åˆ†é’Ÿå†…ç¬¬äºŒæ¬¡è¯·æ±‚å¯†ç é‡ç½®
- **THEN** ç³»ç»Ÿè¿”å› 429 çŠ¶æ€ç 
- **AND** æç¤º"è¯·æ±‚è¿‡äºé¢‘ç¹,è¯·ç¨åå†è¯•"

### Requirement: å¯†ç é‡ç½®éªŒè¯
ç³»ç»Ÿå¿…é¡»éªŒè¯é‡ç½®ä»¤ç‰Œå¹¶å…è®¸ç”¨æˆ·è®¾ç½®æ–°å¯†ç ã€‚

#### Scenario: éªŒè¯æˆåŠŸå¹¶é‡ç½®å¯†ç 
- **WHEN** ç”¨æˆ·æäº¤æœ‰æ•ˆçš„é‡ç½®ä»¤ç‰Œå’Œç¬¦åˆå¼ºåº¦è¦æ±‚çš„æ–°å¯†ç 
- **THEN** ç³»ç»Ÿæ›´æ–°ç”¨æˆ·å¯†ç (ä½¿ç”¨ bcrypt åŠ å¯†)
- **AND** ä½¿é‡ç½®ä»¤ç‰Œå¤±æ•ˆ
- **AND** ä½¿æ‰€æœ‰ç°æœ‰ä¼šè¯ä»¤ç‰Œå¤±æ•ˆ(å¼ºåˆ¶é‡æ–°ç™»å½•)
- **AND** è®°å½•å¯†ç é‡ç½®æ“ä½œæ—¥å¿—
- **AND** å‘é€å¯†ç å·²æ›´æ”¹çš„é€šçŸ¥é‚®ä»¶

#### Scenario: ä»¤ç‰Œè¿‡æœŸ
- **WHEN** ç”¨æˆ·æäº¤çš„é‡ç½®ä»¤ç‰Œå·²è¶…è¿‡15åˆ†é’Ÿæœ‰æ•ˆæœŸ
- **THEN** ç³»ç»Ÿè¿”å› 400 é”™è¯¯
- **AND** æç¤º"é‡ç½®é“¾æ¥å·²è¿‡æœŸ,è¯·é‡æ–°è¯·æ±‚"

#### Scenario: ä»¤ç‰Œæ— æ•ˆ
- **WHEN** ç”¨æˆ·æäº¤çš„é‡ç½®ä»¤ç‰Œä¸å­˜åœ¨æˆ–æ ¼å¼é”™è¯¯
- **THEN** ç³»ç»Ÿè¿”å› 400 é”™è¯¯
- **AND** æç¤º"é‡ç½®é“¾æ¥æ— æ•ˆ"

#### Scenario: æ–°å¯†ç å¼ºåº¦ä¸è¶³
- **WHEN** ç”¨æˆ·æäº¤çš„æ–°å¯†ç ä¸ç¬¦åˆå¼ºåº¦è¦æ±‚(å°‘äº8ä¸ªå­—ç¬¦æˆ–æ— ç‰¹æ®Šå­—ç¬¦)
- **THEN** ç³»ç»Ÿè¿”å› 400 é”™è¯¯
- **AND** æç¤ºå…·ä½“çš„å¯†ç è¦æ±‚

### Requirement: å¯†ç é‡ç½®å®‰å…¨æ—¥å¿—
ç³»ç»Ÿå¿…é¡»è®°å½•æ‰€æœ‰å¯†ç é‡ç½®æ“ä½œä»¥ä¾¿å®¡è®¡ã€‚

#### Scenario: è®°å½•æˆåŠŸæ“ä½œ
- **WHEN** å¯†ç é‡ç½®æˆåŠŸå®Œæˆ
- **THEN** ç³»ç»Ÿè®°å½•æ—¥å¿—åŒ…å«:ç”¨æˆ·IDã€æ“ä½œæ—¶é—´ã€IPåœ°å€ã€User-Agent

#### Scenario: è®°å½•å¤±è´¥å°è¯•
- **WHEN** å¯†ç é‡ç½®å¤±è´¥(ä»¤ç‰Œè¿‡æœŸã€æ— æ•ˆç­‰)
- **THEN** ç³»ç»Ÿè®°å½•æ—¥å¿—åŒ…å«:å°è¯•çš„ä»¤ç‰Œã€å¤±è´¥åŸå› ã€IPåœ°å€
```

**ç¼–å†™ Delta çš„é»„é‡‘æ³•åˆ™:**

1. **æ¯ä¸ªéœ€æ±‚è‡³å°‘1ä¸ªåœºæ™¯,æœ€å¥½3-5ä¸ªåœºæ™¯** - è¦†ç›–æˆåŠŸã€å¤±è´¥ã€è¾¹ç•Œæƒ…å†µ
2. **åœºæ™¯è¦å¯æµ‹è¯•** - èƒ½ç›´æ¥ç¿»è¯‘æˆæµ‹è¯•ç”¨ä¾‹
3. **æ˜ç¡®å®‰å…¨è€ƒè™‘** - æ¶‰åŠè®¤è¯ã€æˆæƒã€æ•æ„Ÿæ•°æ®çš„éœ€æ±‚å¿…é¡»åŒ…å«å®‰å…¨åœºæ™¯
4. **è€ƒè™‘è¾¹ç•Œæ¡ä»¶** - ç©ºå€¼ã€è¶…é•¿è¾“å…¥ã€å¹¶å‘ã€ç½‘ç»œé”™è¯¯ç­‰

#### æ­¥éª¤5: åˆ›å»º design.md(å¯é€‰)

æ ¹æ®ä»¥ä¸‹æ ‡å‡†åˆ¤æ–­æ˜¯å¦éœ€è¦ `design.md`:

**å¿…é¡»åˆ›å»º design.md çš„æƒ…å†µ:**
- âœ… è·¨æœåŠ¡/è·¨æ¨¡å—çš„å˜æ›´
- âœ… å¼•å…¥æ–°çš„å¤–éƒ¨ä¾èµ–(æ•°æ®åº“ã€ç¬¬ä¸‰æ–¹ API ç­‰)
- âœ… æ•°æ®æ¨¡å‹æœ‰é‡å¤§å˜æ›´
- âœ… æ¶‰åŠå®‰å…¨ã€æ€§èƒ½æˆ–åˆè§„æ€§çš„å¤æ‚æ€§
- âœ… éœ€è¦æ•°æ®è¿ç§»æˆ–å›æ»šè®¡åˆ’
- âœ… æŠ€æœ¯æ–¹æ¡ˆæœ‰å¤šä¸ªå¯é€‰é¡¹,éœ€è¦è®°å½•å†³ç­–ç†ç”±

**å¯ä»¥çœç•¥ design.md çš„æƒ…å†µ:**
- âœ… å•ä¸€æ–‡ä»¶çš„ç®€å•ä¿®æ”¹
- âœ… çº¯ UI è°ƒæ•´(ä¸æ¶‰åŠåç«¯)
- âœ… é…ç½®å˜æ›´
- âœ… æŠ€æœ¯æ–¹æ¡ˆæ˜¾è€Œæ˜“è§,æ— äº‰è®®

å¯¹äºæˆ‘ä»¬çš„å¯†ç é‡ç½®åŠŸèƒ½,**éœ€è¦**åˆ›å»º design.md:

```markdown
## Context
ç”¨æˆ·å¯†ç é‡ç½®æ¶‰åŠå®‰å…¨æ•æ„Ÿæ“ä½œ,éœ€è¦å¹³è¡¡å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒã€‚ç°æœ‰ç³»ç»Ÿä½¿ç”¨ JWT è®¤è¯,é‚®ä»¶æœåŠ¡å·²é›†æˆ SendGridã€‚

## Goals / Non-Goals

**Goals:**
- æä¾›å®‰å…¨çš„è‡ªåŠ©å¯†ç é‡ç½®æµç¨‹
- é˜²æ­¢å¸¸è§çš„å¯†ç é‡ç½®æ¼æ´(é‚®ç®±æšä¸¾ã€CSRFã€é‡æ”¾æ”»å‡»)
- ä¸ç°æœ‰è®¤è¯ç³»ç»Ÿæ— ç¼é›†æˆ

**Non-Goals:**
- ä¸æ”¯æŒçŸ­ä¿¡éªŒè¯ç (æœªæ¥å¯æ‰©å±•)
- ä¸æ”¯æŒå®‰å…¨é—®é¢˜éªŒè¯(æ˜“è¢«ç¤¾å·¥æ”»å‡»)

## Decisions

### Decision 1: ä»¤ç‰Œå­˜å‚¨æ–¹å¼
**é€‰æ‹©:** ä½¿ç”¨æ•°æ®åº“è¡¨å­˜å‚¨ä»¤ç‰Œ(è€Œé JWT)

**ç†ç”±:**
- éœ€è¦ä¸»åŠ¨æ’¤é”€èƒ½åŠ›(JWT æ— æ³•æ’¤é”€)
- éœ€è¦è®¾ç½®çŸ­æœ‰æ•ˆæœŸ(15åˆ†é’Ÿ)å¹¶èƒ½ç²¾ç¡®æ§åˆ¶
- éœ€è¦é˜²æ­¢é‡æ”¾æ”»å‡»(ä¸€æ¬¡æ€§ä»¤ç‰Œ)

**Alternatives considered:**
- JWT: æ— æ³•æ’¤é”€,ä¸é€‚åˆä¸€æ¬¡æ€§ä»¤ç‰Œåœºæ™¯
- Redis: å¢åŠ ä¾èµ–,å½“å‰è§„æ¨¡ä¸éœ€è¦

### Decision 2: ä»¤ç‰Œç”Ÿæˆç®—æ³•
**é€‰æ‹©:** ä½¿ç”¨ `crypto.randomBytes(32).toString('hex')`

**ç†ç”±:**
- åŠ å¯†å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆ
- 64ä¸ªå­—ç¬¦é•¿åº¦,è¶³å¤Ÿé˜²æ­¢æš´åŠ›ç ´è§£
- Node.js æ ‡å‡†åº“,æ— é¢å¤–ä¾èµ–

### Decision 3: é‚®ç®±æšä¸¾é˜²æŠ¤
**é€‰æ‹©:** æ— è®ºé‚®ç®±æ˜¯å¦å­˜åœ¨,éƒ½è¿”å›ç›¸åŒçš„æˆåŠŸå“åº”

**ç†ç”±:**
- é˜²æ­¢æ”»å‡»è€…é€šè¿‡å“åº”å·®å¼‚åˆ¤æ–­é‚®ç®±æ˜¯å¦æ³¨å†Œ
- OWASP æ¨èçš„æœ€ä½³å®è·µ

**Trade-off:**
- ç”¨æˆ·æ— æ³•ç¡®è®¤é‚®ç®±æ˜¯å¦æ‹¼å†™é”™è¯¯
- å¯é€šè¿‡"å¦‚æœ10åˆ†é’Ÿå†…æœªæ”¶åˆ°é‚®ä»¶,è¯·æ£€æŸ¥é‚®ç®±æ˜¯å¦æ­£ç¡®"çš„æç¤ºç¼“è§£

### Decision 4: ä¼šè¯å¤±æ•ˆç­–ç•¥
**é€‰æ‹©:** å¯†ç é‡ç½®åä½¿æ‰€æœ‰ç°æœ‰ä¼šè¯ä»¤ç‰Œå¤±æ•ˆ

**ç†ç”±:**
- é˜²æ­¢æ”»å‡»è€…åœ¨ç”¨æˆ·é‡ç½®å¯†ç åä»ä¿æŒè®¿é—®æƒé™
- ç¬¦åˆ"å¯†ç æ›´æ”¹åº”è¯¥è¸¢å‡ºæ‰€æœ‰è®¾å¤‡"çš„å®‰å…¨é¢„æœŸ

**Migration:**
- éœ€è¦åœ¨ users è¡¨æ·»åŠ  `password_changed_at` å­—æ®µ
- JWT éªŒè¯æ—¶æ£€æŸ¥ç­¾å‘æ—¶é—´æ˜¯å¦æ™šäº `password_changed_at`

## Risks / Trade-offs

| Risk | Impact | Mitigation |
|------|--------|-----------|
| é‚®ä»¶æœåŠ¡ä¸å¯ç”¨ | é«˜ - ç”¨æˆ·æ— æ³•é‡ç½®å¯†ç  | å®ç°é‡è¯•æœºåˆ¶ + ç›‘æ§å‘Šè­¦ |
| ä»¤ç‰Œè¡¨è¿‡å¤§ | ä¸­ - å½±å“æŸ¥è¯¢æ€§èƒ½ | å®šæ—¶ä»»åŠ¡æ¸…ç†è¿‡æœŸä»¤ç‰Œ(æ¯å°æ—¶) |
| é¢‘ç‡é™åˆ¶è¿‡ä¸¥ | ä½ - åˆæ³•ç”¨æˆ·è¢«é˜»æ­¢ | ä½¿ç”¨10åˆ†é’Ÿçª—å£ + æä¾›å‹å¥½æç¤º |

## Migration Plan

**æ•°æ®åº“å˜æ›´:**
```sql
-- 1. åˆ›å»ºä»¤ç‰Œè¡¨
CREATE TABLE password_reset_tokens (
  id SERIAL PRIMARY KEY,
  user_id INT NOT NULL REFERENCES users(id),
  token VARCHAR(64) UNIQUE NOT NULL,
  expires_at TIMESTAMP NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);
CREATE INDEX idx_token ON password_reset_tokens(token);
CREATE INDEX idx_expires_at ON password_reset_tokens(expires_at);

-- 2. æ·»åŠ å¯†ç æ›´æ”¹æ—¶é—´å­—æ®µ
ALTER TABLE users ADD COLUMN password_changed_at TIMESTAMP;
UPDATE users SET password_changed_at = NOW(); -- åˆå§‹åŒ–ç°æœ‰ç”¨æˆ·
```

**éƒ¨ç½²æ­¥éª¤:**
1. æ‰§è¡Œæ•°æ®åº“è¿ç§»(å‘åå…¼å®¹)
2. éƒ¨ç½²æ–°ä»£ç 
3. éªŒè¯å¯†ç é‡ç½®æµç¨‹
4. å¯åŠ¨ä»¤ç‰Œæ¸…ç†å®šæ—¶ä»»åŠ¡

**å›æ»šè®¡åˆ’:**
- ä»£ç å›æ»š:ç›´æ¥å›æ»šéƒ¨ç½²
- æ•°æ®åº“å›æ»š:ä¸éœ€è¦(æ–°è¡¨å’Œæ–°å­—æ®µä¸å½±å“æ—§ä»£ç )

## Open Questions
- â“ æ˜¯å¦éœ€è¦æ”¯æŒç®¡ç†å‘˜å¼ºåˆ¶é‡ç½®ç”¨æˆ·å¯†ç ?(æœªæ¥å¯è€ƒè™‘)
- â“ å¯†ç é‡ç½®æ˜¯å¦åº”è§¦å‘å®‰å…¨è­¦å‘Šé‚®ä»¶?(å»ºè®®æ·»åŠ )
```

#### æ­¥éª¤6: éªŒè¯ææ¡ˆ

ä½¿ç”¨ OpenSpec CLI éªŒè¯ææ¡ˆæ ¼å¼:

```bash
# ä¸¥æ ¼æ¨¡å¼éªŒè¯(æ¨è)
openspec validate add-password-reset --strict

# æŸ¥çœ‹è¯¦ç»†è¾“å‡º
openspec show add-password-reset --json --deltas-only
```

**å¸¸è§éªŒè¯é”™è¯¯åŠè§£å†³:**

**é”™è¯¯1: "Change must have at least one delta"**
```
åŸå› : changes/add-password-reset/specs/ ç›®å½•ä¸ºç©ºæˆ–æ²¡æœ‰ .md æ–‡ä»¶
è§£å†³: ç¡®ä¿åˆ›å»ºäº† specs/user-auth/spec.md æ–‡ä»¶
```

**é”™è¯¯2: "Requirement must have at least one scenario"**
```
åŸå› : Scenario æ ¼å¼é”™è¯¯,è§£æå™¨æœªè¯†åˆ«
è§£å†³: æ£€æŸ¥æ˜¯å¦ä½¿ç”¨ #### Scenario: æ ¼å¼(å››ä¸ª #)
```

**é”™è¯¯3: "Invalid delta operation header"**
```
åŸå› : Delta æ“ä½œå¤´æ‹¼å†™é”™è¯¯(å¦‚ ## ADD Requirements)
è§£å†³: ä½¿ç”¨æ­£ç¡®çš„å¤´éƒ¨ ## ADDED Requirements
```

**è°ƒè¯•æŠ€å·§:**
```bash
# å¯¼å‡º JSON æ£€æŸ¥ Delta æ˜¯å¦è¢«æ­£ç¡®è§£æ
openspec show add-password-reset --json | jq '.deltas'

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡º:
# {
#   "user-auth": {
#     "added": [...],
#     "modified": [],
#     "removed": []
#   }
# }
```

#### æ­¥éª¤7: è¯·æ±‚å®¡æ‰¹

ææ¡ˆåˆ›å»ºå®Œæˆå,**ä¸è¦ç«‹å³å¼€å§‹å®ç°**ã€‚åº”è¯¥:

1. **æäº¤ Pull Request** - ä»…åŒ…å« `openspec/changes/add-password-reset/` ç›®å½•
2. **é€šçŸ¥å›¢é˜Ÿ** - åœ¨å›¢é˜Ÿæ²Ÿé€šå·¥å…·ä¸­åˆ†äº«ææ¡ˆé“¾æ¥
3. **æ”¶é›†åé¦ˆ** - ç»™å›¢é˜Ÿæˆå‘˜ 1-2 å¤©å®¡é˜…æ—¶é—´
4. **è®¨è®ºä¿®æ”¹** - æ ¹æ®åé¦ˆè¿­ä»£ææ¡ˆ
5. **æ­£å¼æ‰¹å‡†** - å›¢é˜Ÿ Leader æˆ–æŠ€æœ¯è´Ÿè´£äººæ‰¹å‡†å,æ‰å¼€å§‹å®ç°

**ä¸ºä»€ä¹ˆä¸èƒ½è·³è¿‡å®¡æ‰¹?**
- âœ… é¿å…è¿”å·¥(åœ¨ä»£ç é˜¶æ®µå‘ç°è®¾è®¡é—®é¢˜ä»£ä»·é«˜)
- âœ… çŸ¥è¯†å…±äº«(è®©å›¢é˜Ÿäº†è§£å³å°†å‘ç”Ÿçš„å˜æ›´)
- âœ… é£é™©è¯†åˆ«(å…¶ä»–äººå¯èƒ½å‘ç°ä½ å¿½ç•¥çš„é—®é¢˜)
- âœ… æ¶æ„ä¸€è‡´æ€§(ç¡®ä¿å˜æ›´ç¬¦åˆé¡¹ç›®æ•´ä½“æ¶æ„)

---

### 3.3 é˜¶æ®µ2: å®ç°å˜æ›´

ææ¡ˆæ‰¹å‡†å,è¿›å…¥å®ç°é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µçš„å…³é”®æ˜¯:**ä¸¥æ ¼æŒ‰ç…§ `tasks.md` æ‰§è¡Œ,å¹¶å®æ—¶æ›´æ–°è¿›åº¦**ã€‚

#### å®ç°æµç¨‹

```mermaid
sequenceDiagram
    participant Dev as å¼€å‘è€…
    participant Spec as proposal.md & design.md
    participant Tasks as tasks.md
    participant Code as ä»£ç åº“
    participant Test as æµ‹è¯•

    Dev->>Spec: 1. ä»”ç»†é˜…è¯»ææ¡ˆå’Œè®¾è®¡
    Dev->>Tasks: 2. ç†è§£ä»»åŠ¡æ¸…å•
    Dev->>Tasks: 3. æŒ‰é¡ºåºå®ç°ä»»åŠ¡
    loop æ¯ä¸ªä»»åŠ¡
        Dev->>Code: ç¼–å†™ä»£ç 
        Dev->>Test: ç¼–å†™æµ‹è¯•
        Dev->>Tasks: æ ‡è®°ä¸ºå®Œæˆ [x]
    end
    Dev->>Tasks: 4. ç¡®è®¤æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    Dev->>Code: 5. æäº¤ä»£ç 
```

#### æ­¥éª¤1-2: é˜…è¯»ææ¡ˆå’Œè®¾è®¡

åœ¨å†™ç¬¬ä¸€è¡Œä»£ç å‰,**å¿…é¡»**å®Œæ•´é˜…è¯»:
- `proposal.md` - ç†è§£"ä¸ºä»€ä¹ˆè¦åš"
- `design.md` - ç†è§£"æ€ä¹ˆåš"
- `specs/[capability]/spec.md` (æ‰€æœ‰æ¶‰åŠçš„ Delta) - ç†è§£"éœ€è¦å®ç°ä»€ä¹ˆ"

**é»„é‡‘æ³•åˆ™:** å¦‚æœä½ åœ¨å®ç°è¿‡ç¨‹ä¸­äº§ç”Ÿç–‘é—®,å…ˆå›åˆ°ææ¡ˆæ–‡æ¡£æ‰¾ç­”æ¡ˆã€‚å¦‚æœææ¡ˆæ–‡æ¡£æ²¡æœ‰ç­”æ¡ˆ,è¯´æ˜ææ¡ˆä¸å¤Ÿå®Œå–„,åº”è¯¥å…ˆè¡¥å……ææ¡ˆ,è€Œä¸æ˜¯è‡ªè¡Œå†³å®šã€‚

#### æ­¥éª¤3: æŒ‰ tasks.md é¡ºåºå®ç°

`tasks.md` ä¸­çš„ä»»åŠ¡é¡ºåºæ˜¯ç»è¿‡è€ƒè™‘çš„,é€šå¸¸éµå¾ªä¾èµ–å…³ç³»ã€‚æŒ‰é¡ºåºå®ç°å¯ä»¥é¿å…:
- âŒ é—æ¼å‰ç½®ä¾èµ–(å¦‚å…ˆå†™ API å†å»ºæ•°æ®åº“è¡¨)
- âŒ ä¸Šä¸‹æ–‡åˆ‡æ¢(å¦‚åå¤åœ¨å‰åç«¯ä¹‹é—´è·³è½¬)
- âŒ è¿›åº¦ä¸é€æ˜(æ— æ³•å¿«é€Ÿåˆ¤æ–­å®Œæˆåº¦)

**å®æˆ˜ç¤ºä¾‹:**

tasks.md:
```markdown
## 1. åç«¯å®ç°
- [ ] 1.1 åˆ›å»ºå¯†ç é‡ç½®ä»¤ç‰Œè¡¨
- [ ] 1.2 å®ç° POST /auth/reset-password/request ç«¯ç‚¹
- [ ] 1.3 å®ç° POST /auth/reset-password/verify ç«¯ç‚¹
- [ ] 1.4 æ·»åŠ ä»¤ç‰Œè¿‡æœŸæ¸…ç†å®šæ—¶ä»»åŠ¡
```

å®ç°æ­¥éª¤:
1. æ‰§è¡Œæ•°æ®åº“è¿ç§»è„šæœ¬ â†’ æ ‡è®° `[x] 1.1`
2. ç¼–å†™ `password-reset.service.ts` çš„ `requestReset()` æ–¹æ³• â†’ æ ‡è®° `[x] 1.2`
3. ç¼–å†™ `password-reset.service.ts` çš„ `verifyAndReset()` æ–¹æ³• â†’ æ ‡è®° `[x] 1.3`
4. ç¼–å†™å®šæ—¶ä»»åŠ¡ `cleanup-expired-tokens.cron.ts` â†’ æ ‡è®° `[x] 1.4`

**æ›´æ–° tasks.md:**
```bash
# å®Œæˆä»»åŠ¡å,ç«‹å³æ›´æ–° tasks.md
sed -i 's/- \[ \] 1.1/- [x] 1.1/' openspec/changes/add-password-reset/tasks.md
git add openspec/changes/add-password-reset/tasks.md
git commit -m "feat(password-reset): complete task 1.1 - create token table"
```

#### æ­¥éª¤4: ç¡®ä¿æµ‹è¯•è¦†ç›–

æ¯ä¸ª Scenario éƒ½åº”è¯¥æœ‰å¯¹åº”çš„æµ‹è¯•ã€‚ä½¿ç”¨ Scenario ç›´æ¥ä½œä¸ºæµ‹è¯•ç”¨ä¾‹:

**Spec Delta:**
```markdown
#### Scenario: è¯·æ±‚æˆåŠŸ
- **WHEN** ç”¨æˆ·è¾“å…¥æ³¨å†Œé‚®ç®±å¹¶è¯·æ±‚å¯†ç é‡ç½®
- **THEN** ç³»ç»Ÿç”Ÿæˆå”¯ä¸€çš„é‡ç½®ä»¤ç‰Œ(æœ‰æ•ˆæœŸ15åˆ†é’Ÿ)
- **AND** å‘é€åŒ…å«é‡ç½®é“¾æ¥çš„é‚®ä»¶åˆ°ç”¨æˆ·é‚®ç®±
- **AND** è¿”å› 200 çŠ¶æ€ç å’Œ"é‚®ä»¶å·²å‘é€"æç¤º
```

**æµ‹è¯•ä»£ç :**
```typescript
describe('PasswordResetService', () => {
  describe('requestReset', () => {
    it('should generate token and send email when valid email provided', async () => {
      // WHEN ç”¨æˆ·è¾“å…¥æ³¨å†Œé‚®ç®±å¹¶è¯·æ±‚å¯†ç é‡ç½®
      const email = 'user@example.com';
      const result = await passwordResetService.requestReset(email);

      // THEN ç³»ç»Ÿç”Ÿæˆå”¯ä¸€çš„é‡ç½®ä»¤ç‰Œ(æœ‰æ•ˆæœŸ15åˆ†é’Ÿ)
      const token = await db.query(
        'SELECT * FROM password_reset_tokens WHERE user_id = ?',
        [user.id]
      );
      expect(token).toBeDefined();
      expect(token.expiresAt).toBeCloseTo(Date.now() + 15 * 60 * 1000, -2);

      // AND å‘é€åŒ…å«é‡ç½®é“¾æ¥çš„é‚®ä»¶åˆ°ç”¨æˆ·é‚®ç®±
      expect(emailService.send).toHaveBeenCalledWith({
        to: email,
        subject: 'å¯†ç é‡ç½®',
        body: expect.stringContaining(token.token)
      });

      // AND è¿”å› 200 çŠ¶æ€ç å’Œ"é‚®ä»¶å·²å‘é€"æç¤º
      expect(result.status).toBe(200);
      expect(result.message).toBe('é‚®ä»¶å·²å‘é€');
    });
  });
});
```

**è¦†ç›–ç‡ç›®æ ‡:**
- æ ¸å¿ƒé€»è¾‘(è®¤è¯ã€æ”¯ä»˜ç­‰): 90%+ è¡Œè¦†ç›–ç‡
- ä¸šåŠ¡é€»è¾‘: 80%+ è¡Œè¦†ç›–ç‡
- UI ç»„ä»¶: 60%+ è¡Œè¦†ç›–ç‡

#### æ­¥éª¤5: å®ç°å®Œæˆåçš„æ£€æŸ¥

åœ¨æ ‡è®°æ‰€æœ‰ä»»åŠ¡ä¸º `[x]` ä¹‹å‰,å®Œæˆæœ€åçš„æ£€æŸ¥æ¸…å•:

**ä»£ç è´¨é‡æ£€æŸ¥:**
```bash
# è¿è¡Œ linter
npm run lint

# è¿è¡Œç±»å‹æ£€æŸ¥
npm run type-check

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:e2e
```

**å®‰å…¨æ£€æŸ¥(å¦‚æœæ¶‰åŠè®¤è¯ã€æˆæƒã€æ•æ„Ÿæ•°æ®):**
```bash
# è¿è¡Œå®‰å…¨æ‰«æ
npm audit

# æ£€æŸ¥å¸¸è§å®‰å…¨é—®é¢˜
# - SQL æ³¨å…¥
# - XSS
# - CSRF
# - æ•æ„Ÿä¿¡æ¯æ³„éœ²(æ—¥å¿—ã€é”™è¯¯æç¤º)
```

**æ–‡æ¡£æ›´æ–°:**
- [ ] API æ–‡æ¡£å·²æ›´æ–°(å¦‚ä½¿ç”¨ Swagger/OpenAPI)
- [ ] README å·²æ›´æ–°(å¦‚æœ‰æ–°çš„ç¯å¢ƒå˜é‡æˆ–é…ç½®)
- [ ] CHANGELOG å·²æ·»åŠ æ¡ç›®

**æœ€ç»ˆç¡®è®¤:**
- [ ] æ‰€æœ‰ tasks.md ä¸­çš„ä»»åŠ¡éƒ½æ ‡è®°ä¸º `[x]`
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å·²é€šè¿‡ Code Review
- [ ] æœ¬åœ°æµ‹è¯•ç¯å¢ƒéªŒè¯åŠŸèƒ½æ­£å¸¸

---

### 3.4 é˜¶æ®µ3: å½’æ¡£å˜æ›´

åŠŸèƒ½å·²ç»éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ,ç°åœ¨éœ€è¦å°†å˜æ›´å½’æ¡£,å¹¶æ›´æ–° `specs/` ç›®å½•ã€‚

#### å½’æ¡£æµç¨‹

```bash
# ä½¿ç”¨ OpenSpec CLI è‡ªåŠ¨å½’æ¡£
openspec archive add-password-reset --yes
```

è¿™ä¸ªå‘½ä»¤ä¼š:
1. ç§»åŠ¨ `changes/add-password-reset/` â†’ `changes/archive/2025-10-31-add-password-reset/`
2. åˆå¹¶æ‰€æœ‰ Delta åˆ° `specs/user-auth/spec.md`
3. è¿è¡Œæœ€ç»ˆéªŒè¯ `openspec validate --strict`

#### æ‰‹åŠ¨å½’æ¡£(å¦‚æœ CLI å¤±è´¥)

**æ­¥éª¤1: ç§»åŠ¨å˜æ›´ç›®å½•**
```bash
DATE=$(date +%Y-%m-%d)
mv openspec/changes/add-password-reset \
   openspec/changes/archive/$DATE-add-password-reset
```

**æ­¥éª¤2: åˆå¹¶ Delta åˆ° specs/**

è¿™æ˜¯æœ€å¤æ‚çš„æ­¥éª¤,éœ€è¦æ ¹æ® Delta ç±»å‹æ‰‹åŠ¨åˆå¹¶:

**ADDED Requirements:**
ç›´æ¥è¿½åŠ åˆ° `specs/user-auth/spec.md` çš„ `## Requirements` éƒ¨åˆ†æœ«å°¾ã€‚

**MODIFIED Requirements:**
æ‰¾åˆ°åŸéœ€æ±‚,ç”¨ Delta ä¸­çš„å®Œæ•´å†…å®¹æ›¿æ¢ã€‚

**REMOVED Requirements:**
åˆ é™¤å¯¹åº”çš„éœ€æ±‚å—ã€‚

**RENAMED Requirements:**
ä¿®æ”¹éœ€æ±‚æ ‡é¢˜,ä¿æŒå†…å®¹ä¸å˜ã€‚

**ç¤ºä¾‹ - åˆå¹¶ ADDED:**

Delta æ–‡ä»¶(`changes/archive/2025-10-31-add-password-reset/specs/user-auth/spec.md`):
```markdown
## ADDED Requirements

### Requirement: å¯†ç é‡ç½®è¯·æ±‚
...

### Requirement: å¯†ç é‡ç½®éªŒè¯
...
```

åˆå¹¶åˆ° `specs/user-auth/spec.md`:
```markdown
## Requirements

### Requirement: ç”¨æˆ·æ³¨å†Œ
...

### Requirement: ç”¨æˆ·ç™»å½•
...

### Requirement: å¯†ç é‡ç½®è¯·æ±‚  â† æ–°å¢
...

### Requirement: å¯†ç é‡ç½®éªŒè¯  â† æ–°å¢
...
```

**æ­¥éª¤3: éªŒè¯åˆå¹¶ç»“æœ**
```bash
# éªŒè¯ specs/ ç›®å½•
openspec validate --strict

# å¦‚æœæœ‰é”™è¯¯,æ£€æŸ¥:
# 1. Scenario æ ¼å¼æ˜¯å¦æ­£ç¡®
# 2. æ˜¯å¦æœ‰é‡å¤çš„ Requirement
# 3. æ˜¯å¦é—æ¼äº†æŸäº› Delta
```

#### å½’æ¡£æœ€ä½³å®è·µ

**1. åœ¨ç‹¬ç«‹çš„ Pull Request ä¸­å½’æ¡£**

ä¸è¦åœ¨å®ç° PR ä¸­åŒæ—¶å½’æ¡£ã€‚åŸå› :
- å®ç° PR å·²ç»å¾ˆå¤§,å½’æ¡£ä¼šè®© Review æ›´å›°éš¾
- å½’æ¡£éœ€è¦ç¡®ä¿éƒ¨ç½²æˆåŠŸåå†è¿›è¡Œ
- å½’æ¡£å¯èƒ½éœ€è¦å¤šæ¬¡è°ƒæ•´(åˆå¹¶ Delta å®¹æ˜“å‡ºé”™)

**2. å½’æ¡£å‰çš„éƒ¨ç½²ç¡®è®¤æ¸…å•**
- [ ] åŠŸèƒ½å·²åœ¨ç”Ÿäº§ç¯å¢ƒè¿è¡Œè‡³å°‘24å°æ—¶
- [ ] æ— ä¸¥é‡ bug æŠ¥å‘Š
- [ ] ç›‘æ§æŒ‡æ ‡æ­£å¸¸(æ€§èƒ½ã€é”™è¯¯ç‡ç­‰)
- [ ] ç”¨æˆ·åé¦ˆæ­£é¢

**3. ä¿ç•™å½’æ¡£å†å²**

æ°¸è¿œä¸è¦åˆ é™¤ `changes/archive/` ä¸­çš„å†…å®¹ã€‚å®ƒæ˜¯:
- éœ€æ±‚æ¼”è¿›çš„å†å²è®°å½•
- å†³ç­–ç†ç”±çš„æ¡£æ¡ˆ
- æ–°æˆå‘˜å­¦ä¹ é¡¹ç›®çš„èµ„æ–™

**4. æ›´æ–° project.md(å¦‚æœéœ€è¦)**

å¦‚æœå˜æ›´å¼•å…¥äº†æ–°çš„çº¦å®šã€æ¨¡å¼æˆ–å·¥å…·,æ›´æ–° `openspec/project.md`:

```markdown
## Project Conventions

### Authentication Patterns
- ä½¿ç”¨ JWT è¿›è¡Œä¼šè¯ç®¡ç†
- å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†(cost factor: 12)
- å¯†ç é‡ç½®ä»¤ç‰Œä½¿ç”¨æ•°æ®åº“å­˜å‚¨,æœ‰æ•ˆæœŸ15åˆ†é’Ÿ  â† æ–°å¢
```

---

## å››ã€é«˜çº§è¯é¢˜ä¸æœ€ä½³å®è·µ

### 4.1 å¤š Capability å˜æ›´

æœ‰æ—¶ä¸€ä¸ªå˜æ›´éœ€è¦å½±å“å¤šä¸ª capabilityã€‚ä¾‹å¦‚,æ·»åŠ "è®¢å•å¯¼å‡º"åŠŸèƒ½,éœ€è¦åŒæ—¶ä¿®æ”¹ `order-management` å’Œ `data-export` capabilityã€‚

#### ç›®å½•ç»“æ„

```
openspec/changes/add-order-export/
â”œâ”€â”€ proposal.md
â”œâ”€â”€ tasks.md
â”œâ”€â”€ design.md
â””â”€â”€ specs/
    â”œâ”€â”€ order-management/
    â”‚   â””â”€â”€ spec.md       # MODIFIED: æ·»åŠ å¯¼å‡ºAPI
    â””â”€â”€ data-export/
        â””â”€â”€ spec.md       # ADDED: æ–°å¢è®¢å•å¯¼å‡ºæ ¼å¼
```

#### proposal.md ç¤ºä¾‹

```markdown
## Why
å®¢æˆ·éœ€è¦æ‰¹é‡å¯¼å‡ºè®¢å•æ•°æ®ç”¨äºè´¢åŠ¡å¯¹è´¦,æ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ•ˆç‡ä½ä¸”æ˜“å‡ºé”™ã€‚

## What Changes
- åœ¨è®¢å•ç®¡ç†æ¨¡å—æ·»åŠ "å¯¼å‡º"æŒ‰é’®å’Œ API
- åœ¨æ•°æ®å¯¼å‡ºæ¨¡å—æ–°å¢è®¢å•å¯¼å‡ºæ ¼å¼(CSV, Excel)
- æ”¯æŒæŒ‰æ—¥æœŸèŒƒå›´å’Œè®¢å•çŠ¶æ€ç­›é€‰

## Impact
- Affected specs: order-management, data-export
- Affected code:
  - `src/orders/export.controller.ts` - æ–°æ§åˆ¶å™¨
  - `src/export/formatters/order.formatter.ts` - æ–°æ ¼å¼åŒ–å™¨
  - `frontend/pages/orders.tsx` - æ·»åŠ å¯¼å‡ºæŒ‰é’®
```

#### Delta ç¼–å†™

`specs/order-management/spec.md`:
```markdown
## MODIFIED Requirements

### Requirement: è®¢å•åˆ—è¡¨æŸ¥è¯¢
ç³»ç»Ÿå¿…é¡»æä¾›è®¢å•åˆ—è¡¨æŸ¥è¯¢å’Œå¯¼å‡ºåŠŸèƒ½ã€‚

#### Scenario: æŸ¥è¯¢æˆåŠŸ
...

#### Scenario: å¯¼å‡ºä¸º CSV  â† æ–°å¢
- **WHEN** ç”¨æˆ·ç‚¹å‡»"å¯¼å‡º"å¹¶é€‰æ‹© CSV æ ¼å¼
- **THEN** ç³»ç»Ÿç”ŸæˆåŒ…å«å½“å‰ç­›é€‰æ¡ä»¶ä¸‹æ‰€æœ‰è®¢å•çš„ CSV æ–‡ä»¶
- **AND** è§¦å‘æµè§ˆå™¨ä¸‹è½½
```

`specs/data-export/spec.md`:
```markdown
## ADDED Requirements

### Requirement: è®¢å•æ•°æ®å¯¼å‡ºæ ¼å¼
ç³»ç»Ÿå¿…é¡»æ”¯æŒè®¢å•æ•°æ®çš„ç»“æ„åŒ–å¯¼å‡ºã€‚

#### Scenario: CSV æ ¼å¼å¯¼å‡º
- **WHEN** è¯·æ±‚ CSV æ ¼å¼çš„è®¢å•å¯¼å‡º
- **THEN** ç”ŸæˆåŒ…å«ä»¥ä¸‹å­—æ®µçš„ CSV: è®¢å•å·ã€åˆ›å»ºæ—¶é—´ã€å®¢æˆ·åç§°ã€é‡‘é¢ã€çŠ¶æ€
- **AND** ä½¿ç”¨ UTF-8 ç¼–ç 
- **AND** æ—¥æœŸæ ¼å¼ä¸º YYYY-MM-DD HH:mm:ss

#### Scenario: Excel æ ¼å¼å¯¼å‡º
- **WHEN** è¯·æ±‚ Excel æ ¼å¼çš„è®¢å•å¯¼å‡º
- **THEN** ç”Ÿæˆ .xlsx æ–‡ä»¶
- **AND** åŒ…å«è¡¨å¤´è¡Œ
- **AND** é‡‘é¢åˆ—ä½¿ç”¨è´§å¸æ ¼å¼
```

### 4.2 Breaking Changes å¤„ç†

ç ´åæ€§å˜æ›´æ˜¯ä¸å¯é¿å…çš„,ä½†å¿…é¡»è°¨æ…å¤„ç†ã€‚

#### è¯†åˆ« Breaking Change

ä»¥ä¸‹æƒ…å†µå±äºç ´åæ€§å˜æ›´:
- âŒ åˆ é™¤æˆ–é‡å‘½å API ç«¯ç‚¹
- âŒ ä¿®æ”¹ API è¯·æ±‚/å“åº”ç»“æ„(å­—æ®µåˆ é™¤ã€ç±»å‹å˜æ›´)
- âŒ æ•°æ®åº“è¡¨ç»“æ„å˜æ›´(åˆ é™¤åˆ—ã€ä¿®æ”¹çº¦æŸ)
- âŒ æ”¹å˜é»˜è®¤è¡Œä¸º(å¯èƒ½ç ´åç°æœ‰é›†æˆ)

#### Breaking Change çš„ææ¡ˆæ¨¡æ¿

```markdown
## Why
ç°æœ‰çš„ API å“åº”æ ¼å¼ä¸æ”¯æŒåˆ†é¡µ,å¯¼è‡´å¤§æ•°æ®é‡æŸ¥è¯¢æ—¶æ€§èƒ½é—®é¢˜ã€‚

## What Changes
- **BREAKING**: ä¿®æ”¹ GET /api/orders å“åº”æ ¼å¼
- åŸæ ¼å¼: `{ orders: [...] }`
- æ–°æ ¼å¼: `{ data: [...], pagination: { total, page, perPage } }`

## Impact
- Affected specs: order-api
- Affected code: `src/orders/orders.controller.ts`
- **Breaking Impact**:
  - æ‰€æœ‰è°ƒç”¨ GET /api/orders çš„å®¢æˆ·ç«¯éœ€è¦æ›´æ–°
  - å½±å“ 3 ä¸ªå†…éƒ¨æœåŠ¡ + ç§»åŠ¨ç«¯ App

## Migration Plan
1. **V1 - è¿‡æ¸¡æœŸ(2å‘¨):**
   - æ–°å¢ GET /api/v2/orders (æ–°æ ¼å¼)
   - ä¿ç•™ GET /api/orders (æ—§æ ¼å¼,æ ‡è®°ä¸º deprecated)
   - åœ¨å“åº”å¤´æ·»åŠ  `X-API-Version: 1` å’Œ `Deprecation: true`

2. **V2 - è¿ç§»æœŸ(1ä¸ªæœˆ):**
   - å‘å¸ƒè¿ç§»æŒ‡å—
   - é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯å¼€å‘å›¢é˜Ÿ
   - ç›‘æ§ /api/orders çš„è°ƒç”¨é‡

3. **V3 - åºŸå¼ƒæœŸ:**
   - å½“ /api/orders è°ƒç”¨é‡ < 5% æ—¶,ç§»é™¤æ—§ç«¯ç‚¹
   - æ›´æ–°æ–‡æ¡£,ç§»é™¤æ‰€æœ‰æ—§æ ¼å¼å¼•ç”¨
```

#### ä½¿ç”¨ REMOVED çš„æ³¨æ„äº‹é¡¹

```markdown
## REMOVED Requirements

### Requirement: è®¢å•åˆ—è¡¨æŸ¥è¯¢(æ—§æ ¼å¼)
**Reason**: ä¸æ”¯æŒåˆ†é¡µ,æ€§èƒ½é—®é¢˜
**Migration**:
- ä½¿ç”¨æ–°ç«¯ç‚¹ GET /api/v2/orders
- å“åº”æ ¼å¼å˜æ›´è¯¦è§è¿ç§»æŒ‡å—: docs/migration/v1-to-v2.md
- æ—§ç«¯ç‚¹å°†åœ¨ 2025-12-31 å®Œå…¨ä¸‹çº¿
**Deprecated Since**: 2025-10-31
**Removal Date**: 2025-12-31
```

### 4.3 ä¸ AI å·¥å…·é›†æˆ

OpenSpec çš„è®¾è®¡åˆè¡·æ˜¯è®© AI ç¼–ç¨‹åŠ©æ‰‹èƒ½æ›´å¥½åœ°ç†è§£é¡¹ç›®éœ€æ±‚ã€‚ä»¥ä¸‹æ˜¯ä¸ä¸»æµ AI å·¥å…·é›†æˆçš„æœ€ä½³å®è·µã€‚

#### ä¸ Claude Code é›†æˆ

åœ¨ `.claude/CLAUDE.md` ä¸­æ·»åŠ :

```markdown
## OpenSpec å·¥ä½œæµ

åœ¨å¼€å§‹ä»»ä½•é trivial çš„åŠŸèƒ½å¼€å‘å‰,å¿…é¡»:
1. è¿è¡Œ `openspec list` å’Œ `openspec list --specs` äº†è§£ç°çŠ¶
2. åˆ›å»ºå˜æ›´ææ¡ˆ(å‚è€ƒ openspec/AGENTS.md)
3. ç­‰å¾…ææ¡ˆå®¡æ‰¹åå†å¼€å§‹å®ç°

åœ¨å®ç°é˜¶æ®µ:
- ä¸¥æ ¼æŒ‰ç…§ `changes/[id]/specs/` ä¸­çš„ Scenario ç¼–å†™ä»£ç 
- æ¯ä¸ª Scenario å¯¹åº”è‡³å°‘ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹
- å®æ—¶æ›´æ–° `changes/[id]/tasks.md` çš„ä»»åŠ¡çŠ¶æ€
```

#### æç¤ºè¯æ¨¡æ¿

**è®© AI åˆ›å»ºææ¡ˆ:**
```
è¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ª OpenSpec å˜æ›´ææ¡ˆ,åŠŸèƒ½æ˜¯[æè¿°åŠŸèƒ½]ã€‚

è¦æ±‚:
1. å…ˆè¿è¡Œ openspec list å’Œ openspec list --specs æ£€æŸ¥ç°çŠ¶
2. é€‰æ‹©åˆé€‚çš„å˜æ›´ ID(kebab-case,åŠ¨è¯å¼€å¤´)
3. åˆ›å»º proposal.md, tasks.md, design.md(å¦‚éœ€è¦)
4. åœ¨ specs/[capability]/spec.md ä¸­ç¼–å†™ Delta
5. æ¯ä¸ªéœ€æ±‚è‡³å°‘åŒ…å«3ä¸ª Scenario(æˆåŠŸã€å¤±è´¥ã€è¾¹ç•Œ)
6. è¿è¡Œ openspec validate --strict éªŒè¯æ ¼å¼
```

**è®© AI å®ç°ææ¡ˆ:**
```
è¯·æŒ‰ç…§ openspec/changes/[change-id]/ ä¸­çš„ææ¡ˆå®ç°åŠŸèƒ½ã€‚

è¦æ±‚:
1. å…ˆå®Œæ•´é˜…è¯» proposal.md, design.md, specs/
2. ä¸¥æ ¼æŒ‰ç…§ tasks.md çš„é¡ºåºå®ç°
3. æ¯ä¸ª Scenario ç¼–å†™å¯¹åº”çš„æµ‹è¯•
4. å®Œæˆä»»åŠ¡åç«‹å³æ›´æ–° tasks.md æ ‡è®°ä¸º [x]
5. ä¸è¦åç¦»ææ¡ˆä¸­çš„è®¾è®¡å†³ç­–
```

#### è®© AI å½’æ¡£å˜æ›´

```
è¯·å½’æ¡£å·²å®Œæˆçš„å˜æ›´ openspec/changes/[change-id]/ã€‚

æ­¥éª¤:
1. ç§»åŠ¨åˆ° changes/archive/[YYYY-MM-DD]-[change-id]/
2. å°†æ‰€æœ‰ Delta åˆå¹¶åˆ° specs/[capability]/spec.md:
   - ADDED: è¿½åŠ åˆ° Requirements éƒ¨åˆ†æœ«å°¾
   - MODIFIED: å®Œæ•´æ›¿æ¢åŸéœ€æ±‚
   - REMOVED: åˆ é™¤å¯¹åº”éœ€æ±‚
   - RENAMED: ä¿®æ”¹éœ€æ±‚æ ‡é¢˜
3. è¿è¡Œ openspec validate --strict ç¡®ä¿æ— è¯¯
4. å¦‚æœ‰æ–°çº¦å®š,æ›´æ–° openspec/project.md
```

### 4.4 è§„æ ¼ä¸ä»£ç çš„åŒæ­¥ç­–ç•¥

**æœ€å¤§çš„æŒ‘æˆ˜:è§„æ ¼ä¸ä»£ç ä¸ä¸€è‡´ã€‚**

#### åŒæ­¥æ£€æŸ¥æ¸…å•

**åœ¨æ¯æ¬¡ Sprint/è¿­ä»£ç»“æŸæ—¶:**
- [ ] æ‰€æœ‰å·²éƒ¨ç½²çš„å˜æ›´å·²å½’æ¡£
- [ ] `specs/` ç›®å½•åæ˜ ç”Ÿäº§ç¯å¢ƒçš„çœŸå®çŠ¶æ€
- [ ] æ— é—ç•™çš„"åƒµå°¸"å˜æ›´(é•¿æœŸæœªå®ç°ä¹Ÿæœªåˆ é™¤çš„ææ¡ˆ)

**åœ¨æ¯æ¬¡ Code Review æ—¶:**
- [ ] æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åº”çš„ OpenSpec ææ¡ˆ
- [ ] ææ¡ˆæ˜¯å¦å·²æ‰¹å‡†
- [ ] ä»£ç å®ç°æ˜¯å¦åç¦»ææ¡ˆ(å¦‚åç¦»,æ˜¯å¦æ›´æ–°äº†ææ¡ˆ)

**åœ¨æ¯æ¬¡ Bug ä¿®å¤æ—¶:**
- [ ] å¦‚æœ bug æ˜¯å› ä¸ºå®ç°åç¦»è§„æ ¼,æ›´æ–°ä»£ç 
- [ ] å¦‚æœ bug æ˜¯å› ä¸ºè§„æ ¼æœ¬èº«æœ‰é—®é¢˜,å…ˆä¿®å¤è§„æ ¼,å†ä¿®å¤ä»£ç 
- [ ] è§„æ ¼ä¿®å¤ä½¿ç”¨æ­£å¸¸çš„å˜æ›´ææ¡ˆæµç¨‹(å³ä½¿æ˜¯ bug)

#### é˜²æ­¢ä¸åŒæ­¥çš„æŠ€æœ¯æ‰‹æ®µ

**1. Git Pre-commit Hook**

```bash
#!/bin/bash
# .git/hooks/pre-commit

# æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç å˜æ›´ä½†æ— ç›¸åº”çš„ openspec å˜æ›´
CHANGED_CODE=$(git diff --cached --name-only | grep -E '\.(ts|js|tsx|jsx|py|go)$')
CHANGED_SPEC=$(git diff --cached --name-only | grep 'openspec/')

if [ -n "$CHANGED_CODE" ] && [ -z "$CHANGED_SPEC" ]; then
  echo "âš ï¸  ä»£ç å˜æ›´ä½†æœªæ›´æ–° OpenSpec"
  echo "å¦‚æœè¿™æ˜¯æ–°åŠŸèƒ½,è¯·åˆ›å»ºå˜æ›´ææ¡ˆ"
  echo "å¦‚æœè¿™æ˜¯ bug ä¿®å¤æˆ–çç¢ä¿®æ”¹,å¯å¿½ç•¥æ­¤è­¦å‘Š"
  echo ""
  read -p "ç»§ç»­æäº¤? (y/n) " -n 1 -r
  echo
  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    exit 1
  fi
fi
```

**2. CI æ£€æŸ¥**

```yaml
# .github/workflows/openspec-check.yml
name: OpenSpec Check

on: [pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Validate OpenSpec
        run: |
          npx openspec validate --strict
      - name: Check for active changes
        run: |
          ACTIVE_CHANGES=$(ls openspec/changes | grep -v archive | wc -l)
          if [ $ACTIVE_CHANGES -gt 3 ]; then
            echo "âš ï¸  è­¦å‘Š: æœ‰ $ACTIVE_CHANGES ä¸ªæ´»è·ƒå˜æ›´,è€ƒè™‘å½’æ¡£å·²å®Œæˆçš„"
          fi
```

**3. å®šæœŸå®¡è®¡**

æ¯æœˆè¿›è¡Œä¸€æ¬¡ OpenSpec å®¡è®¡:
```bash
# ç”Ÿæˆå®¡è®¡æŠ¥å‘Š
openspec list > /tmp/active-changes.txt
openspec list --specs > /tmp/capabilities.txt

# æ£€æŸ¥:
# 1. æ˜¯å¦æœ‰è¶…è¿‡1ä¸ªæœˆæœªæ›´æ–°çš„æ´»è·ƒå˜æ›´?
# 2. æ˜¯å¦æœ‰ capability ç¼ºå°‘ design.md?
# 3. æ˜¯å¦æœ‰å­¤ç«‹çš„è§„æ ¼(ä»£ç å·²åˆ é™¤ä½†è§„æ ¼æœªåˆ é™¤)?
```

### 4.5 å›¢é˜Ÿåä½œä¸å†²çªè§£å†³

å¤šäººåŒæ—¶åˆ›å»ºå˜æ›´ææ¡ˆæ—¶,å¯èƒ½å‡ºç°å†²çªã€‚

#### å†²çªåœºæ™¯

**åœºæ™¯1: åŒæ—¶ä¿®æ”¹åŒä¸€ä¸ª Capability**

å¼€å‘è€… A åˆ›å»º `add-order-notes`,å¼€å‘è€… B åˆ›å»º `add-order-tags`,éƒ½ä¿®æ”¹ `order-management` capabilityã€‚

**è§£å†³:**
1. è°å…ˆåˆå¹¶è°å ä¼˜å…ˆ
2. ååˆå¹¶çš„äººéœ€è¦ rebase å¹¶è§£å†³ Delta å†²çª
3. é‡æ–°è¿è¡Œ `openspec validate --strict`

**åœºæ™¯2: å˜æ›´ ID å†²çª**

ä¸¤äººéƒ½åˆ›å»ºäº† `add-export-feature`ã€‚

**è§£å†³:**
- åå‘ç°çš„äººé‡å‘½åä¸º `add-export-feature-2` æˆ–æ›´å…·ä½“çš„åç§°(å¦‚ `add-order-export`)
- æ›´æ–°æ‰€æœ‰æ–‡æ¡£ä¸­çš„å¼•ç”¨

**åœºæ™¯3: è®¾è®¡æ–¹æ¡ˆå†²çª**

ä¸¤ä¸ªææ¡ˆé‡‡ç”¨äº†å†²çªçš„æŠ€æœ¯æ–¹æ¡ˆ(å¦‚ä¸€ä¸ªç”¨ REST,ä¸€ä¸ªç”¨ GraphQL)ã€‚

**è§£å†³:**
1. æš‚åœå®ç°,å¬å¼€æŠ€æœ¯è¯„å®¡ä¼šè®®
2. ç»Ÿä¸€æŠ€æœ¯æ–¹æ¡ˆå,åˆå¹¶æˆ–åºŸå¼ƒå…¶ä¸­ä¸€ä¸ªææ¡ˆ
3. æ›´æ–° `openspec/project.md` è®°å½•å†³ç­–

#### åä½œæœ€ä½³å®è·µ

**1. æ¯æ—¥åŒæ­¥**
å›¢é˜Ÿæ¯æ—¥ç«™ä¼šæ—¶åŒæ­¥:
- æˆ‘æ˜¨å¤©å®Œæˆäº†å“ªäº›å˜æ›´?
- æˆ‘ä»Šå¤©è¦å¼€å§‹å“ªä¸ªæ–°å˜æ›´?
- æ˜¯å¦æœ‰ capability å†²çªçš„é£é™©?

**2. ææ¡ˆè®¤é¢†æœºåˆ¶**
åœ¨ææ¡ˆç›®å½•ä¸­æ·»åŠ  `OWNERS` æ–‡ä»¶:
```markdown
# openspec/changes/add-password-reset/OWNERS
Owner: @alice
Reviewers: @bob, @charlie
Status: In Progress
Start Date: 2025-10-15
Target Completion: 2025-10-30
```

**3. ä½¿ç”¨ Draft PR**
åˆ›å»ºææ¡ˆåç«‹å³å¼€ Draft PR,è®©å›¢é˜ŸçŸ¥é“"è¿™å—åœ°æˆ‘å äº†"ã€‚

---

## äº”ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### Q1: OpenSpec ä¼šå¢åŠ å¤šå°‘å·¥ä½œé‡?

**A:** å–å†³äºä½ ä¹‹å‰çš„æµç¨‹:
- å¦‚æœä¹‹å‰æ²¡æœ‰è§„æ ¼æ–‡æ¡£,åˆæœŸæŠ•å…¥çº¦ 20% é¢å¤–æ—¶é—´,ä½†åæœŸæ”¶ç›Š(å‡å°‘è¿”å·¥ã€æå‡ AI ä»£ç è´¨é‡)è¿œè¶…æŠ•å…¥
- å¦‚æœä¹‹å‰å·²æœ‰è§„æ ¼æ–‡æ¡£,OpenSpec ä¸»è¦æ˜¯æ”¹å˜ç»„ç»‡æ–¹å¼,é¢å¤–å¼€é”€ < 5%

**æ•°æ®æ”¯æŒ:**
- é‡‡ç”¨ OpenSpec çš„å›¢é˜Ÿ,AI ç”Ÿæˆä»£ç çš„å¯ç”¨ç‡ä» 40% æå‡åˆ° 70%+
- éœ€æ±‚å˜æ›´å¯¼è‡´çš„è¿”å·¥æ—¶é—´å‡å°‘ 50%+

### Q2: å°å›¢é˜Ÿ(2-3äºº)æ˜¯å¦é€‚åˆä½¿ç”¨ OpenSpec?

**A:** é€‚åˆ,ç”šè‡³æ›´é€‚åˆã€‚å°å›¢é˜Ÿçš„é—®é¢˜:
- æ²Ÿé€šæˆæœ¬ä½,å®¹æ˜“å¿½ç•¥æ–‡æ¡£
- äººå‘˜æµåŠ¨æ—¶çŸ¥è¯†æµå¤±ä¸¥é‡
- ä½¿ç”¨ AI æ—¶ç¼ºä¹ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡

OpenSpec æä¾›è½»é‡çº§çš„è§„æ ¼ç®¡ç†,å°å›¢é˜Ÿå¯ä»¥çœç•¥ `design.md`,åªä¿ç•™ `proposal.md` å’Œ `spec.md`ã€‚

### Q3: å¦‚ä½•è¯´æœå›¢é˜Ÿé‡‡ç”¨ OpenSpec?

**A:** åˆ†ä¸‰æ­¥:

**Step 1: è¯•ç‚¹é¡¹ç›®(1-2å‘¨)**
é€‰æ‹©ä¸€ä¸ªå°åŠŸèƒ½,å®Œæ•´èµ°ä¸€é OpenSpec æµç¨‹,å±•ç¤ºæ•ˆæœã€‚

**Step 2: é‡åŒ–æ”¶ç›Š**
å¯¹æ¯”è¯•ç‚¹é¡¹ç›®å‰åçš„æŒ‡æ ‡:
- AI ç”Ÿæˆä»£ç çš„è¿”å·¥æ¬¡æ•°
- Code Review ä¸­éœ€æ±‚ç†è§£ç›¸å…³çš„é—®é¢˜æ•°é‡
- æ–°æˆå‘˜ç†è§£åŠŸèƒ½æ‰€éœ€æ—¶é—´

**Step 3: æ¸è¿›å¼æ¨å¹¿**
- å…ˆè¦æ±‚æ‰€æœ‰"æ–°åŠŸèƒ½"ä½¿ç”¨ OpenSpec
- æ—§ä»£ç é€æ­¥è¡¥å……è§„æ ¼(ä¸å¼ºåˆ¶)
- å»ºç«‹ OpenSpec æœ€ä½³å®è·µåˆ†äº«æœºåˆ¶

### Q4: OpenSpec ä¸ Jira/Linear ç­‰é¡¹ç›®ç®¡ç†å·¥å…·å¦‚ä½•é…åˆ?

**A:** OpenSpec ä¸“æ³¨äº"è§„æ ¼çœŸç›¸",é¡¹ç›®ç®¡ç†å·¥å…·ä¸“æ³¨äº"ä»»åŠ¡è·Ÿè¸ª"ã€‚æ¨èé›†æˆæ–¹å¼:

**æ–¹æ¡ˆ1: Jira Task â†’ OpenSpec Change**
```
Jira Epic: [FEAT-123] ç”¨æˆ·å¯†ç é‡ç½®
  â”œâ”€ Task: [FEAT-123-1] åˆ›å»º OpenSpec ææ¡ˆ
  â”œâ”€ Task: [FEAT-123-2] å®ç°åç«¯ API
  â”œâ”€ Task: [FEAT-123-3] å®ç°å‰ç«¯é¡µé¢
  â””â”€ Task: [FEAT-123-4] å½’æ¡£ OpenSpec å˜æ›´

åœ¨ Jira Task æè¿°ä¸­æ·»åŠ :
OpenSpec Change ID: add-password-reset
OpenSpec Path: openspec/changes/add-password-reset/
```

**æ–¹æ¡ˆ2: åŒå‘åŒæ­¥(é«˜çº§)**
ä½¿ç”¨ GitHub Actions åŒæ­¥:
- OpenSpec `tasks.md` æ›´æ–° â†’ è‡ªåŠ¨æ›´æ–° Jira Task çŠ¶æ€
- Jira Task å…³é—­ â†’ è§¦å‘ OpenSpec å½’æ¡£æ£€æŸ¥

### Q5: å¦‚ä½•å¤„ç†å¿«é€Ÿè¿­ä»£åœºæ™¯(å¦‚ Hackathonã€MVP)?

**A:** OpenSpec æ”¯æŒ"é™çº§æ¨¡å¼":

**MVP æ¨¡å¼:**
- çœç•¥ `design.md`
- `proposal.md` ç®€åŒ–ä¸º 3-5 å¥è¯
- `spec.md` åªå†™æ ¸å¿ƒåœºæ™¯(1-2ä¸ª)
- `tasks.md` ä½¿ç”¨ checklist è€Œéè¯¦ç»†æè¿°

**ç¤ºä¾‹:**
```markdown
# proposal.md
## Why
éªŒè¯å¸‚åœºéœ€æ±‚

## What
ç”¨æˆ·æ³¨å†Œ + ç™»å½•

## Impact
æ–°å¢ user-auth capability

---

# specs/user-auth/spec.md
## ADDED Requirements

### Requirement: ç”¨æˆ·æ³¨å†Œ
#### Scenario: æˆåŠŸæ³¨å†Œ
- **WHEN** æä¾›é‚®ç®±å’Œå¯†ç 
- **THEN** åˆ›å»ºè´¦æˆ·

### Requirement: ç”¨æˆ·ç™»å½•
#### Scenario: æˆåŠŸç™»å½•
- **WHEN** æä¾›æ­£ç¡®å‡­è¯
- **THEN** è¿”å› token
```

**æŠ€æœ¯å€ºåŠ¡ç®¡ç†:**
MVP å®Œæˆå,å¦‚æœå†³å®šç»§ç»­å¼€å‘,åˆ›å»ºä¸€ä¸ª `refactor-user-auth-spec` å˜æ›´,è¡¥å……å®Œæ•´è§„æ ¼ã€‚

### Q6: OpenSpec CLI å·¥å…·çš„ `validate` å‘½ä»¤æ€»æ˜¯æŠ¥é”™æ€ä¹ˆåŠ?

**A:** å¸¸è§åŸå› å’Œè§£å†³æ–¹æ³•:

**é”™è¯¯1: "Requirement must have at least one scenario"**
```bash
# è°ƒè¯•æ­¥éª¤:
openspec show [change-id] --json --deltas-only | jq '.deltas[].added'

# æ£€æŸ¥ Scenario æ˜¯å¦è¢«æ­£ç¡®è§£æ
# å¦‚æœè¾“å‡ºä¸º null æˆ– [],è¯´æ˜ Scenario æ ¼å¼é”™è¯¯

# å¸¸è§é”™è¯¯æ ¼å¼:
âŒ ### Scenario: xxx       # ä¸‰ä¸ª #
âŒ - **Scenario: xxx**     # åˆ—è¡¨é¡¹
âŒ **Scenario**: xxx       # ç²—ä½“å†’å·

âœ… #### Scenario: xxx      # å››ä¸ª #,åè·Ÿå†’å·å’Œç©ºæ ¼
```

**é”™è¯¯2: "Delta operation header not recognized"**
```bash
# æ£€æŸ¥ Delta å¤´éƒ¨æ‹¼å†™
âœ… ## ADDED Requirements
âœ… ## MODIFIED Requirements
âœ… ## REMOVED Requirements
âœ… ## RENAMED Requirements

âŒ ## ADD Requirements      # ç¼ºå°‘ ED
âŒ ## Added requirements    # é¦–å­—æ¯å°å†™
âŒ ##ADDED Requirements     # ç¼ºå°‘ç©ºæ ¼
```

**é”™è¯¯3: "Change directory not found"**
```bash
# ç¡®ä¿ç›®å½•ç»“æ„æ­£ç¡®
changes/
â””â”€â”€ your-change-id/          # å¿…é¡»æœ‰æ­¤ç›®å½•
    â””â”€â”€ specs/               # å¿…é¡»æœ‰ specs å­ç›®å½•
        â””â”€â”€ capability-name/  # è‡³å°‘ä¸€ä¸ª capability
            â””â”€â”€ spec.md      # å¿…é¡»æœ‰ spec.md
```

---

## å…­ã€æ€»ç»“ä¸è¡ŒåŠ¨å»ºè®®

### OpenSpec çš„æ ¸å¿ƒä»·å€¼

1. **ç»Ÿä¸€çœŸç›¸æº** - è§„æ ¼æ˜¯å”¯ä¸€æƒå¨,ä»£ç æœä»è§„æ ¼
2. **AI å‹å¥½** - ç»“æ„åŒ–æ ¼å¼è®© AI ç²¾å‡†ç†è§£éœ€æ±‚
3. **å˜æ›´å¯è¿½æº¯** - æ¯ä¸ªåŠŸèƒ½çš„æ¥é¾™å»è„‰éƒ½æœ‰è®°å½•
4. **å›¢é˜Ÿåä½œ** - ææ¡ˆé©±åŠ¨,å‡å°‘å£å¤´æ²Ÿé€šçš„è¯¯è§£
5. **çŸ¥è¯†æ²‰æ·€** - æ–°äººé€šè¿‡é˜…è¯»è§„æ ¼å¿«é€Ÿä¸Šæ‰‹

### ç«‹å³å¼€å§‹ä½¿ç”¨ OpenSpec

**ç¬¬ä¸€æ­¥: åˆå§‹åŒ–é¡¹ç›®(5åˆ†é’Ÿ)**
```bash
# å®‰è£… OpenSpec CLI
npm install -g openspec-cli

# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆå§‹åŒ–
cd your-project
openspec init

# ç¼–è¾‘ openspec/project.md,å¡«å†™é¡¹ç›®ä¿¡æ¯
```

**ç¬¬äºŒæ­¥: åˆ›å»ºç¬¬ä¸€ä¸ªå˜æ›´ææ¡ˆ(30åˆ†é’Ÿ)**
é€‰æ‹©ä¸€ä¸ªå°åŠŸèƒ½(å¦‚"ç”¨æˆ·å¤´åƒä¸Šä¼ "),å®Œæ•´èµ°ä¸€éæµç¨‹:
1. `openspec list --specs` - äº†è§£ç°çŠ¶
2. åˆ›å»ºå˜æ›´ç›®å½•å’Œæ–‡ä»¶
3. ç¼–å†™ proposal.md, tasks.md, spec.md
4. `openspec validate --strict` - éªŒè¯æ ¼å¼
5. åˆ†äº«ç»™å›¢é˜Ÿè·å–åé¦ˆ

**ç¬¬ä¸‰æ­¥: å®ç°å¹¶å½’æ¡£(1-2å¤©)**
æŒ‰ç…§ææ¡ˆå®ç°åŠŸèƒ½,éƒ¨ç½²åå½’æ¡£:
1. æŒ‰ tasks.md å®ç°
2. éƒ¨ç½²åˆ°ç”Ÿäº§
3. `openspec archive [change-id] --yes`

**ç¬¬å››æ­¥: å»ºç«‹å›¢é˜Ÿæµç¨‹(1å‘¨)**
- åœ¨å›¢é˜Ÿä¼šè®®ä¸Šåˆ†äº« OpenSpec ç»éªŒ
- åˆ¶å®šå›¢é˜Ÿçš„ OpenSpec çº¦å®š(å†™å…¥ project.md)
- å°† OpenSpec é›†æˆåˆ° CI/CD

### è¿›é˜¶å­¦ä¹ èµ„æº

- **OpenSpec GitHub**: https://github.com/openspec/openspec (å‡è®¾é“¾æ¥)
- **è§„æ ¼é©±åŠ¨å¼€å‘æœ€ä½³å®è·µ**: å‚è€ƒ GitHub Spec Kit æ–‡æ¡£
- **ç¤¾åŒºè®¨è®º**: åŠ å…¥ OpenSpec Discord/Slack ç¤¾åŒº
- **ç¤ºä¾‹é¡¹ç›®**: æŸ¥çœ‹ `openspec/examples/` ä»“åº“

### æœ€åçš„è¯

è§„æ ¼é©±åŠ¨å¼€å‘ä¸æ˜¯é“¶å¼¹,ä½†å®ƒæ˜¯åœ¨ AI æ—¶ä»£ä¿æŒä»£ç è´¨é‡å’Œé¡¹ç›®å¯æ§æ€§çš„æœ€ä½³å®è·µä¹‹ä¸€ã€‚OpenSpec æä¾›çš„è½»é‡çº§æ¡†æ¶,è®©ä½ åœ¨äº«å— AI ç¼–ç¨‹æ•ˆç‡çš„åŒæ—¶,ä¸å¤±å»ä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹çš„ä¸¥è°¨æ€§ã€‚

**è®°ä½ä¸‰ä¸ªåŸåˆ™:**
1. **è§„æ ¼å…ˆè¡Œ** - å…ˆå†™è§„æ ¼,å†å†™ä»£ç 
2. **å¢é‡å˜æ›´** - æ¯ä¸ªå˜æ›´éƒ½é€šè¿‡æ­£å¼ææ¡ˆ
3. **æŒç»­åŒæ­¥** - ä»£ç ä¸è§„æ ¼å§‹ç»ˆä¸€è‡´

ç°åœ¨,å¼€å§‹ä½ çš„ OpenSpec ä¹‹æ—…å§!ğŸš€

---

**ä½œè€…:AI + äººç±»åä½œåˆ›ä½œ**
**æœ€åæ›´æ–°:2025-10-31**
**ç‰ˆæœ¬:1.0**

---

## é™„å½• A: å¿«é€Ÿå‚è€ƒå¡ç‰‡

### OpenSpec CLI å¸¸ç”¨å‘½ä»¤
```bash
openspec list                        # åˆ—å‡ºæ´»è·ƒå˜æ›´
openspec list --specs                # åˆ—å‡ºæ‰€æœ‰ capability
openspec show [item]                 # æŸ¥çœ‹å˜æ›´æˆ–è§„æ ¼è¯¦æƒ…
openspec validate [item] --strict    # ä¸¥æ ¼æ¨¡å¼éªŒè¯
openspec archive [change-id] --yes   # å½’æ¡£å˜æ›´
openspec init [path]                 # åˆå§‹åŒ– OpenSpec
```

### Scenario æ ¼å¼æ¨¡æ¿
```markdown
#### Scenario: æè¿°æ€§åç§°
- **WHEN** å‰ç½®æ¡ä»¶
- **THEN** é¢„æœŸç»“æœ
- **AND** é¢å¤–ç»“æœ(å¯é€‰)
```

### Delta æ“ä½œé€ŸæŸ¥
- `## ADDED Requirements` - æ–°å¢éœ€æ±‚(å®Œå…¨æ–°çš„åŠŸèƒ½)
- `## MODIFIED Requirements` - ä¿®æ”¹éœ€æ±‚(æ”¹å˜è¡Œä¸º,éœ€åŒ…å«å®Œæ•´å†…å®¹)
- `## REMOVED Requirements` - åˆ é™¤éœ€æ±‚(éœ€æä¾›ç†ç”±å’Œè¿ç§»æ–¹æ¡ˆ)
- `## RENAMED Requirements` - é‡å‘½åéœ€æ±‚(ä»…æ”¹åç§°)

### å˜æ›´ ID å‘½åè§„èŒƒ
- æ ¼å¼: `<verb>-<noun>-<noun>` (kebab-case)
- åŠ¨è¯: `add-`, `update-`, `remove-`, `refactor-`, `migrate-`
- ç¤ºä¾‹: `add-two-factor-auth`, `update-payment-retry-logic`

---

## é™„å½• B: OpenSpec vs å…¶ä»–å·¥å…·å¯¹æ¯”

| ç‰¹æ€§ | OpenSpec | GitHub Spec Kit | Confluence | Notion |
|------|----------|----------------|------------|--------|
| æ–‡ä»¶æ ¼å¼ | Markdown | Markdown | å¯Œæ–‡æœ¬ | å¯Œæ–‡æœ¬ |
| ç‰ˆæœ¬æ§åˆ¶ | Git åŸç”Ÿ | Git åŸç”Ÿ | æœ‰é™ | æœ‰é™ |
| AI å¯è¯»æ€§ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| äººç±»å¯è¯»æ€§ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| å­¦ä¹ æ›²çº¿ | ä½ | ä½ | ä¸­ | ä½ |
| å˜æ›´ç®¡ç† | å†…ç½® | æ—  | æ‰‹åŠ¨ | æ‰‹åŠ¨ |
| CLI å·¥å…· | âœ… | âœ… | âŒ | âŒ |
| å¼€æº | âœ… | âœ… | âŒ | âŒ |
| é€‚åˆå›¢é˜Ÿè§„æ¨¡ | 2-50+ | 2-20 | 10-1000+ | 2-100+ |

**é€‰æ‹©å»ºè®®:**
- **2-10äººå°å›¢é˜Ÿ,é‡åº¦ä½¿ç”¨ AI**: OpenSpec
- **éœ€è¦å¤æ‚åä½œã€å®¡æ‰¹æµç¨‹**: Confluence
- **éæŠ€æœ¯å›¢é˜Ÿå‚ä¸**: Notion
- **GitHub æ·±åº¦ç”¨æˆ·**: GitHub Spec Kit

---

*å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©,æ¬¢è¿åˆ†äº«ç»™æ›´å¤šå¼€å‘è€…!*
*æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®,æ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®º!*
